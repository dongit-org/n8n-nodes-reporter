import {
    IExecuteFunctions,
    INodeExecutionData,
    INodeType,
    INodeTypeDescription,
    IDataObject,
    ILoadOptionsFunctions,
    INodePropertyOptions,
    IBinaryKeyData,
} from "n8n-workflow";

export class Reporter implements INodeType {
    description: INodeTypeDescription = {
        displayName: "Reporter",
        name: "reporter",
        icon: "file:reporter.svg",
        group: [],
        version: 1,
        description: "Interact with Reporter API",
        defaults: {
            name: "Reporter",
        },
        inputs: ["main"],
        outputs: ["main"],
        credentials: [
            {
                name: "reporterApi",
                required: true,
            },
        ],
        properties: [
            {
                displayName: "Resource",
                name: "resource",
                type: "options",
                noDataExpression: true,
                options: [
                    {
                        name: "Activity",
                        value: "activity",
                    },
                    {
                        name: "Assessment",
                        value: "assessment",
                    },
                    {
                        name: "Assessment Comment",
                        value: "assessmentComment",
                    },
                    {
                        name: "Assessment Phase",
                        value: "assessmentPhase",
                    },
                    {
                        name: "Assessment Section",
                        value: "assessmentSection",
                    },
                    {
                        name: "Assessment Section Comment",
                        value: "assessmentSectionComment",
                    },
                    {
                        name: "Assessment Task Set",
                        value: "assessmentTaskSet",
                    },
                    {
                        name: "Assessment Template",
                        value: "assessmentTemplate",
                    },
                    {
                        name: "Assessment User",
                        value: "assessmentUser",
                    },
                    {
                        name: "Client",
                        value: "client",
                    },
                    {
                        name: "Custom Field",
                        value: "customField",
                    },
                    {
                        name: "Document",
                        value: "document",
                    },
                    {
                        name: "Finding",
                        value: "finding",
                    },
                    {
                        name: "Finding Layout",
                        value: "findingLayout",
                    },
                    {
                        name: "Finding Event",
                        value: "findingEvent",
                    },
                    {
                        name: "Finding Template",
                        value: "findingTemplate",
                    },
                    {
                        name: "Language",
                        value: "language",
                    },
                    {
                        name: "Output File",
                        value: "outputFile",
                    },
                    {
                        name: "Tool Finding",
                        value: "toolFinding",
                    },
                    {
                        name: "Tool Target",
                        value: "toolTarget",
                    },
                    {
                        name: "Reaction",
                        value: "reaction",
                    },
                    {
                        name: "Role",
                        value: "role",
                    },
                    {
                        name: "Target",
                        value: "target",
                    },
                    {
                        name: "Task",
                        value: "task",
                    },
                    {
                        name: "Task Set",
                        value: "taskSet",
                    },
                    {
                        name: "Test Case",
                        value: "testCase",
                    },
                    {
                        name: "Theme",
                        value: "theme",
                    },
                    {
                        name: "User",
                        value: "user",
                    },
                    {
                        name: "User Group",
                        value: "userGroup",
                    },
                ],
                default: "activity",
            },

            // Activity - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["activity"],
                    },
                },
                options: [
                    {
                        name: "List activities",
                        value: "listActivities",
                        action: "List activities",
                        description:
                            "Retrieve a list of all accessible activities. Object information.",
                    },
                ],
                default: "listActivities",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["activity"],
                        operation: ["listActivities"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Assessment id",
                                                value: "assessment_id",
                                            },
                                            {
                                                name: "User id",
                                                value: "user_id",
                                            },
                                            {
                                                name: "Impersonator id",
                                                value: "impersonator_id",
                                            },
                                            {
                                                name: "Finding id",
                                                value: "finding_id",
                                            },
                                            {
                                                name: "Type",
                                                value: "type",
                                            },
                                            {
                                                name: "Through api",
                                                value: "through_api",
                                            },
                                            {
                                                name: "Through scim",
                                                value: "through_scim",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            // Assessment - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                    },
                },
                options: [
                    {
                        name: "List assessments",
                        value: "listAssessments",
                        action: "List assessments",
                        description:
                            "Retrieve a list of all accessible assessments. Object information.",
                    },
                    {
                        name: "Create an assessment",
                        value: "createAnAssessment",
                        action: "Create an assessment",
                        description:
                            "Create a new assessment. Object information.",
                    },
                    {
                        name: "Retrieve an assessment",
                        value: "retrieveAnAssessment",
                        action: "Retrieve an assessment",
                        description:
                            "Retrieve all details of the given assessment. Object information.",
                    },
                    {
                        name: "Update an assessment",
                        value: "updateAnAssessment",
                        action: "Update an assessment",
                        description:
                            "Update the posted assessment. Object information.",
                    },
                    {
                        name: "Retrieve the full PDF report",
                        value: "retrieveTheFullPDFReport",
                        action: "Retrieve the full PDF report",
                        description:
                            'This route supports both GET and POST requests. The POST request supports passing a password that will be used to encrypt the resulting PDF report. If an admin has enabled the "Password-protect PDF...',
                    },
                    {
                        name: "Retrieve the management PDF report",
                        value: "retrieveTheManagementPDFReport",
                        action: "Retrieve the management PDF report",
                        description:
                            'This route supports both GET and POST requests. The POST request supports passing a password that will be used to encrypt the resulting PDF report. If an admin has enabled the "Password-protect PDF...',
                    },
                ],
                default: "listAssessments",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["listAssessments"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Assessment template name",
                                                value: "assessment_template_name",
                                            },
                                            {
                                                name: "Status",
                                                value: "status",
                                            },
                                            {
                                                name: "Title",
                                                value: "title",
                                            },
                                            {
                                                name: "Completed date",
                                                value: "completed_date",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Client id",
                name: "client_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["createAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadClients",
                },
                default: undefined,
                description:
                    "The ID of the client. Example: 299ddbbcb5d04424ac08954f60c6acae",
            },

            {
                displayName: "Assessment template id",
                name: "assessment_template_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["createAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmenttemplates",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "ID of the assessment template. The id of an existing record in the assessment_templates table. Example: owasp_top10_2021",
            },
            {
                displayName: "Title",
                name: "title",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["createAnAssessment"],
                    },
                },
                default: "",
                description:
                    "The title of the assessment. Must not be greater than 191 characters. Example: SuperApp periodic",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["createAnAssessment"],
                    },
                },
                options: [
                    {
                        displayName: "Language id",
                        name: "language_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadLanguages",
                        },
                        default: undefined,
                        description:
                            "The language of the assessment template to be used when creating the assessment. Defaults to the default language of the template. Example: en",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Tags to organize assessments. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Tags to organize assessments. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        default: "",
                        description:
                            "A short description. Must not be greater than 191 characters. Example: White-box test",
                    },

                    {
                        displayName: "Scoring system",
                        name: "scoring_system",
                        type: "options",
                        options: [
                            {
                                name: "OWASP",
                                value: "owasp",
                                description: "OWASP",
                            },
                            {
                                name: "PASSI",
                                value: "passi",
                                description: "PASSI",
                            },
                            {
                                name: "CVSS V3.1",
                                value: "cvss_v3_1",
                                description: "CVSS V3.1",
                            },
                            {
                                name: "CVSS V4.0",
                                value: "cvss_v4_0",
                                description: "CVSS V4.0",
                            },
                            {
                                name: "Severity Only",
                                value: "severity_only",
                                description: "Severity Only",
                            },
                            {
                                name: "Audit Rating",
                                value: "audit_rating",
                                description: "Audit Rating",
                            },
                        ],
                        default: "owasp",
                        description:
                            "The scoring system used by the assessment. If not set, the default scoring system will be used. The default scoring system can be changed in the settings. Must be a valid scoring system. Example: o...",
                    },

                    {
                        displayName: "Theme id",
                        name: "theme_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadThemes",
                        },
                        default: undefined,
                        description:
                            "ID of the report theme. If this is not set, the default theme will be used. Example: ea861e6df8f8487f851459e8a875cd50",
                    },

                    {
                        displayName: "Finding layout id",
                        name: "finding_layout_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadFindinglayouts",
                            loadOptionsDependsOn: ["id"],
                        },
                        default: undefined,
                        description:
                            "ID of the used finding layout. If this is not set, the finding layout will be used. Example: e4a59443ed374e7282d1a67543b81a7f",
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["createAnAssessment"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsAssessment",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["retrieveAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: ddb7f558f8d841b482c6c482844092d5",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["retrieveAnAssessment"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["updateAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: ddb7f558f8d841b482c6c482844092d5",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["updateAnAssessment"],
                    },
                },
                options: [
                    {
                        displayName: "Assessment template id",
                        name: "assessment_template_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadAssessmenttemplates",
                            loadOptionsDependsOn: ["id"],
                        },
                        default: undefined,
                        description:
                            "ID of the assessment template. This can only be changed if the assessment has no findings. If this parameter is provided and `assessment_template_name` is not, then the assessment template name wil...",
                    },

                    {
                        displayName: "Assessment template name",
                        name: "assessment_template_name",
                        type: "string",
                        default: "",
                        description:
                            "Name of the assessment template. Must not be greater than 191 characters. Example: OWASP Top 10 - version 2021",
                    },

                    {
                        displayName: "Client id",
                        name: "client_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadClients",
                        },
                        default: undefined,
                        description:
                            "ID of the client organization. Example: 34d8595d2cf64f379eeeb8a02709df8c",
                    },

                    {
                        displayName: "Language id",
                        name: "language_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadLanguages",
                        },
                        default: undefined,
                        description: "ID of the used language. Example: 2",
                    },

                    {
                        displayName: "Theme id",
                        name: "theme_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadThemes",
                        },
                        default: undefined,
                        description:
                            "ID of the used theme. Example: 8745c32101d72c47888be5a320392e17",
                    },

                    {
                        displayName: "Finding layout id",
                        name: "finding_layout_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadFindinglayouts",
                            loadOptionsDependsOn: ["id"],
                        },
                        default: undefined,
                        description:
                            "ID of the used finding layout. Example: e4a59443ed374e7282d1a67543b81a7f",
                    },

                    {
                        displayName: "Status",
                        name: "status",
                        type: "options",
                        options: [
                            {
                                name: "Pending",
                                value: 0,
                                description: "Pending",
                            },
                            {
                                name: "Scheduled",
                                value: 1,
                                description: "Scheduled",
                            },
                            {
                                name: "Active",
                                value: 2,
                                description: "Active",
                            },
                            {
                                name: "Under Review",
                                value: 6,
                                description: "Under Review",
                            },
                            {
                                name: "Review Completed",
                                value: 8,
                                description: "Review Completed",
                            },
                            {
                                name: "Completed",
                                value: 3,
                                description: "Completed",
                            },
                            {
                                name: "Retest Requested",
                                value: 11,
                                description: "Retest Requested",
                            },
                            {
                                name: "Retest Scheduled",
                                value: 4,
                                description: "Retest Scheduled",
                            },
                            {
                                name: "Retest Active",
                                value: 5,
                                description: "Retest Active",
                            },
                            {
                                name: "Retest Under Review",
                                value: 7,
                                description: "Retest Under Review",
                            },
                            {
                                name: "Retest Review Completed",
                                value: 9,
                                description: "Retest Review Completed",
                            },
                            {
                                name: "Retest Completed",
                                value: 10,
                                description: "Retest Completed",
                            },
                            {
                                name: "Continuous",
                                value: 12,
                                description: "Continuous",
                            },
                        ],
                        default: 0,
                        description:
                            "The current assessment status. Must be a valid assessment status. Example: 5",
                    },

                    {
                        displayName: "On hold",
                        name: "on_hold",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the assessment is put on hold. This will notify researchers and block the creation of new findings. Example: false",
                    },

                    {
                        displayName: "Classifications",
                        name: "classifications",
                        type: "options",
                        options: [
                            {
                                name: "CWE",
                                value: "CWE",
                                description: "CWE",
                            },
                            {
                                name: "CAPEC",
                                value: "CAPEC",
                                description: "CAPEC",
                            },
                            {
                                name: "VRT",
                                value: "VRT",
                                description: "VRT",
                            },
                        ],
                        default: "CWE",
                        description:
                            'Classification system(s) used for this assessment. Must be a valid classifications. Example: ["doloremque"]',
                    },

                    {
                        displayName: "Scoring system",
                        name: "scoring_system",
                        type: "options",
                        options: [
                            {
                                name: "OWASP",
                                value: "owasp",
                                description: "OWASP",
                            },
                            {
                                name: "PASSI",
                                value: "passi",
                                description: "PASSI",
                            },
                            {
                                name: "CVSS V3.1",
                                value: "cvss_v3_1",
                                description: "CVSS V3.1",
                            },
                            {
                                name: "CVSS V4.0",
                                value: "cvss_v4_0",
                                description: "CVSS V4.0",
                            },
                            {
                                name: "Severity Only",
                                value: "severity_only",
                                description: "Severity Only",
                            },
                            {
                                name: "Audit Rating",
                                value: "audit_rating",
                                description: "Audit Rating",
                            },
                        ],
                        default: "owasp",
                        description:
                            "Scoring System. The scoring system cannot be changed once the assessment has findings. Must be a valid scoring system. Example: owasp",
                    },

                    {
                        displayName: "Title",
                        name: "title",
                        type: "string",
                        default: "",
                        description:
                            "The title of the assessment. Must not be greater than 191 characters. Example: SuperApp Periodic",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Tags to organize assessments. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Tags to organize assessments. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        default: "",
                        description:
                            "A short description. Must not be greater than 191 characters. Example: White-box test",
                    },

                    {
                        displayName: "Internal details",
                        name: "internal_details",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Internal Details. Example: Technical Contact(s) ...",
                    },

                    {
                        displayName: "Total research hours",
                        name: "total_research_hours",
                        type: "number",
                        typeOptions: {
                            minValue: 0,
                            maxValue: 9999,
                        },
                        default: "",
                        description:
                            "Total Research Hours, including reviewing and reporting. This field is required when researcher_research_hours is present. Must not be greater than 9999. Must be at least 0. Example: 6",
                    },

                    {
                        displayName: "Show targets",
                        name: "show_targets",
                        type: "boolean",
                        default: "",
                        description:
                            "Show the assessment targets as a tab in the overview. Example: false",
                    },

                    {
                        displayName: "Show results",
                        name: "show_results",
                        type: "boolean",
                        default: "",
                        description:
                            "Show the assessment results as a tab in the overview. Example: false",
                    },

                    {
                        displayName: "Auto generate pdf",
                        name: "auto_generate_pdf",
                        type: "boolean",
                        default: "",
                        description:
                            "Automatic PDF Generation. Once this assessment is completed automatically generate a new PDF on changing the assessment or any related data (like targets, sections or findings). Example: false",
                    },

                    {
                        displayName: "Auto generate management pdf",
                        name: "auto_generate_management_pdf",
                        type: "boolean",
                        default: "",
                        description:
                            "Automatic Management PDF Generation. Once this assessment is completed automatically generate a new management PDF on changing the assessment or any related data (like targets, sections or findings...",
                    },

                    {
                        displayName: "Management report available",
                        name: "management_report_available",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether clients are allowed to download management report PDFs. Example: false",
                    },

                    {
                        displayName: "Show report toc",
                        name: "show_report_toc",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether a table of contents will be included when generating assessment reports. Example: false",
                    },

                    {
                        displayName: "Show management report toc",
                        name: "show_management_report_toc",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether a table of contents will be included when generating management assessment reports. Example: false",
                    },

                    {
                        displayName: "Enable retest requests",
                        name: "enable_retest_requests",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether clients can request new retests. Example: false",
                    },

                    {
                        displayName: "Allow retests without inquiries",
                        name: "allow_retests_without_inquiries",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether researchers can create retests without an explicit request from a client. Example: false",
                    },

                    {
                        displayName: "Password protect pdf reports",
                        name: "password_protect_pdf_reports",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether assessment report generation is password-protected. Example: false",
                    },

                    {
                        displayName: "Researcher research hours",
                        name: "researcher_research_hours",
                        type: "number",
                        typeOptions: {
                            minValue: 0,
                            maxValue: 9999,
                        },
                        default: "",
                        description:
                            "Amount of research hours visible to researchers. This does not include reviewing and reporting. This field is required when total_research_hours is present. Must not be greater than 9999. Must be a...",
                    },

                    {
                        displayName: "Researcher briefing",
                        name: "researcher_briefing",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Researcher Briefing. Example: Research Introduction",
                    },

                    {
                        displayName: "Researcher account details",
                        name: "researcher_account_details",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Account Details and Credentials. This field is intended to store credentials that do not apply to a specific target. Target-specific credentials should be attached to the target itself. Example: Lo...",
                    },

                    {
                        displayName: "Schedule color",
                        name: "schedule_color",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Schedule Background Color. This color is used as background for phases in the assessment schedule calendar view. Example: #4d84d1",
                    },

                    {
                        displayName: "Custom short id",
                        name: "custom_short_id",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether to use a full custom short ID, instead of a short ID based on client's short ID and initial assessment start date. Example: false",
                    },

                    {
                        displayName: "Include short id in finding id",
                        name: "include_short_id_in_finding_id",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether to prefix each finding ID with the short ID of the assessment. Example: false",
                    },

                    {
                        displayName: "Finding number digits",
                        name: "finding_number_digits",
                        type: "number",
                        typeOptions: {
                            minValue: 1,
                            maxValue: 6,
                        },
                        default: "",
                        description:
                            "Minimum number of digits to use for finding numbers. Must be at least 1. Must not be greater than 6. Example: 3",
                    },

                    {
                        displayName: "Client user groups",
                        name: "client_user_groups",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'The user groups assigned to this assessment. Example: ["cc6fa3815c654afbb34c54042edacc84"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'The user groups assigned to this assessment. Example: ["cc6fa3815c654afbb34c54042edacc84"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Restrict findings to resolvers",
                        name: "restrict_findings_to_resolvers",
                        type: "boolean",
                        default: "",
                        description:
                            "If enabled, clients can only see a finding if they, or a group they belong to is explicitly assigned as a resolver for that finding. Clients are also unable to access PDF reports because they may c...",
                    },

                    {
                        displayName: "Researchers on report",
                        name: "researchers_on_report",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Whether the researchers with the IDs as keys should appear in the report as a reviewer. If is_reviewer is true, the researchers will appear in the report as reviewers, else, they will appear in the...",
                    },

                    {
                        displayName: "Shared information",
                        name: "shared_information",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Shared Information. Example: Shared Information",
                    },

                    {
                        displayName: "Results table options",
                        name: "results_table_options",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Options for the results table on the assessment overview page. These options will also serve as default options for results table components in reports, but can be overridden on a per-component bas...",
                    },

                    {
                        displayName: "Short id",
                        name: "short_id",
                        type: "string",
                        default: "",
                        description:
                            "Full custom Short ID. Use a custom short ID instead of a short ID based on client's short ID and initial assessment start date. Make sure custom_short_id is set to true. Must not be greater than 12...",
                    },

                    {
                        displayName: "Local short id",
                        name: "local_short_id",
                        type: "string",
                        default: "",
                        description:
                            "Short ID. This short ID is unique for every assessment and can be used as a quick reference to the assessment and the associated findings. This assessment short ID includes the client's short ID an...",
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["updateAnAssessment"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsAssessment",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["retrieveTheFullPDFReport"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 730a2bbc89cd4ec6a166ae700c30671d",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["retrieveTheFullPDFReport"],
                    },
                },
                options: [
                    {
                        displayName: "Password",
                        name: "password",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            'Used to encrypt the report PDF with a password. **Forbidden** in a GET request. **Required** if the "Password-protect PDF reports" application setting is enabled. Must be at least 8 characters. Exa...',
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["retrieveTheManagementPDFReport"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: a43fe6b88ec54bd88173da12e44538ad",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessment"],
                        operation: ["retrieveTheManagementPDFReport"],
                    },
                },
                options: [
                    {
                        displayName: "Password",
                        name: "password",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            'Used to encrypt the report PDF with a password. **Forbidden** in a GET request. **Required** if the "Password-protect PDF reports" application setting is enabled. Must be at least 8 characters. Exa...',
                    },
                ],
            },

            // Assessment Comment - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentComment"],
                    },
                },
                options: [
                    {
                        name: "Create an assessment comment",
                        value: "createAnAssessmentComment",
                        action: "Create an assessment comment",
                        description:
                            "Create a new assessment comment. Object information.",
                    },
                    {
                        name: "Update an assessment comment",
                        value: "updateAnAssessmentComment",
                        action: "Update an assessment comment",
                        description:
                            "Update an existing assessment comment. Object information.",
                    },
                ],
                default: "createAnAssessmentComment",
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentComment"],
                        operation: ["createAnAssessmentComment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 57998d542f904a8ba050458d5445cdda",
            },

            {
                displayName: "Body",
                name: "body",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentComment"],
                        operation: ["createAnAssessmentComment"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The text of the comment. Example: Can you clarify ...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentComment"],
                        operation: ["createAnAssessmentComment"],
                    },
                },
                options: [
                    {
                        displayName: "Is private",
                        name: "is_private",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the comment can be read by clients. Example: false",
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentComment"],
                        operation: ["updateAnAssessmentComment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentcomments",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment comment. Example: 3ec9db33121e4d83b621e14f11f4a476",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentComment"],
                        operation: ["updateAnAssessmentComment"],
                    },
                },
                options: [
                    {
                        displayName: "Body",
                        name: "body",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The text of the comment. Example: Can you clarify ...",
                    },

                    {
                        displayName: "Is private",
                        name: "is_private",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the comment can be read by clients. Example: false",
                    },
                ],
            },

            // Assessment Phase - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentPhase"],
                    },
                },
                options: [
                    {
                        name: "Update an assessment phase",
                        value: "updateAnAssessmentPhase",
                        action: "Update an assessment phase",
                        description:
                            "Update an existing assessment phase. Object information.",
                    },
                ],
                default: "updateAnAssessmentPhase",
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentPhase"],
                        operation: ["updateAnAssessmentPhase"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentphases",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment phase. Example: 7a24827363054ba3aec3e4bee3842a0b",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentPhase"],
                        operation: ["updateAnAssessmentPhase"],
                    },
                },
                options: [
                    {
                        displayName: "Research start date",
                        name: "research_start_date",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The date at which the researchers start their research. This field is required when research_deadline, review_start_date, review_deadline, or delivery_date is present. Must be a valid date. Example...",
                    },

                    {
                        displayName: "Research deadline",
                        name: "research_deadline",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The date at which the researchers are planned to finish their research. This field is required when review_start_date or review_deadline is present. Must be a valid date. Must be a date after or eq...",
                    },

                    {
                        displayName: "Review start date",
                        name: "review_start_date",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The date at which the reviewers will start reviewing the research. This field is required when review_deadline is present. Must be a valid date. Must be a date after or equal to research_start_date...",
                    },

                    {
                        displayName: "Review deadline",
                        name: "review_deadline",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The date at which the reviewers are planned to complete the review. This field is required when review_start_date is present. Must be a valid date. Must be a date after or equal to research_start_d...",
                    },

                    {
                        displayName: "Delivery date",
                        name: "delivery_date",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The latest date at which the reviewed research report should be delivered to the client. Must be a valid date. Must be a date after or equal to research_start_date. Must be a date after or equal to...",
                    },

                    {
                        displayName: "Researchers",
                        name: "researchers",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'IDs of researchers scheduled to work on this phase of the assessment. Does not grant access. Example: ["49147a95c3e349abb6820937c916894d"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'IDs of researchers scheduled to work on this phase of the assessment. Does not grant access. Example: ["49147a95c3e349abb6820937c916894d"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Reviewers",
                        name: "reviewers",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'IDs of reviewers scheduled to work on this phase of the assessment. Does not grant access. Example: ["a34eec2920fe48b988e41ea4bc3261b4"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'IDs of reviewers scheduled to work on this phase of the assessment. Does not grant access. Example: ["a34eec2920fe48b988e41ea4bc3261b4"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Visible on report",
                        name: "visible_on_report",
                        type: "boolean",
                        default: "",
                        description:
                            "If true, the phase will appear in the started-on report component. Example: false",
                    },

                    {
                        displayName: "Note",
                        name: "note",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "For scheduling notes and agreements with clients. Not shown to clients or researchers. Example: Do not test on mondays",
                    },
                ],
            },

            // Assessment Section - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSection"],
                    },
                },
                options: [
                    {
                        name: "Retrieve an assessment section",
                        value: "retrieveAnAssessmentSection",
                        action: "Retrieve an assessment section",
                        description:
                            "Retrieve all details of the given assessment section. Object information.",
                    },
                    {
                        name: "Update an assessment section",
                        value: "updateAnAssessmentSection",
                        action: "Update an assessment section",
                        description:
                            "Update an existing assessment section. Object information.",
                    },
                ],
                default: "retrieveAnAssessmentSection",
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSection"],
                        operation: ["retrieveAnAssessmentSection"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentsections",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment section. Example: 95d1ae0d060847beb593c14069b61af9",
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSection"],
                        operation: ["updateAnAssessmentSection"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentsections",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment section. Example: 95d1ae0d060847beb593c14069b61af9",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentSection"],
                        operation: ["updateAnAssessmentSection"],
                    },
                },
                options: [
                    {
                        displayName: "Name",
                        name: "name",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Name of the section. Example: Introduction",
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The contents of the section (markdown). Example: This report describes findings of ..",
                    },

                    {
                        displayName: "Can have findings",
                        name: "can_have_findings",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether this section and any sub sections can have findings assigned. Example: false",
                    },

                    {
                        displayName: "Finding is required",
                        name: "finding_is_required",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether it is required to have at least one finding in this section. Example: false",
                    },

                    {
                        displayName: "Report section visibility",
                        name: "report_section_visibility",
                        type: "options",
                        options: [
                            {
                                name: "Yes",
                                value: 1,
                                description: "Yes",
                            },
                            {
                                name: "No, hide section and subsections",
                                value: 2,
                                description: "No, hide section and subsections",
                            },
                            {
                                name: "Yes, show if has findings",
                                value: 3,
                                description: "Yes, show if has findings",
                            },
                        ],
                        default: 1,
                        description:
                            "Whether this section will be included in the report. Must be a valid report section visibility. Example: 18",
                    },

                    {
                        displayName: "Is visible in assessment overview",
                        name: "is_visible_in_assessment_overview",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether this section will be shown in the assessment overview web page. Example: false",
                    },

                    {
                        displayName: "Text editable with permission",
                        name: "text_editable_with_permission",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether this section can be edited by researchers. Example: false",
                    },

                    {
                        displayName: "Force page break after section",
                        name: "force_page_break_after_section",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether a page break is forced in the PDF report after this section. The page break will appear before any child sections. Example: false",
                    },

                    {
                        displayName: "Management report section visibility",
                        name: "management_report_section_visibility",
                        type: "options",
                        options: [
                            {
                                name: "Yes",
                                value: 1,
                                description: "Yes",
                            },
                            {
                                name: "No, hide section and subsections",
                                value: 2,
                                description: "No, hide section and subsections",
                            },
                            {
                                name: "Yes, show if has findings",
                                value: 3,
                                description: "Yes, show if has findings",
                            },
                        ],
                        default: 1,
                        description:
                            "Whether this section will be included in the management report. Must be a valid report section visibility. Example: 5",
                    },

                    {
                        displayName: "Report heading",
                        name: "report_heading",
                        type: "options",
                        options: [
                            {
                                name: "Heading 1 (starts on new page)",
                                value: 1,
                                description: "Heading 1 (starts on new page)",
                            },
                            {
                                name: "Heading 2",
                                value: 2,
                                description: "Heading 2",
                            },
                            {
                                name: "Heading 3",
                                value: 3,
                                description: "Heading 3",
                            },
                            {
                                name: "Heading 4",
                                value: 4,
                                description: "Heading 4",
                            },
                            {
                                name: "Heading 5",
                                value: 5,
                                description: "Heading 5",
                            },
                            {
                                name: "Heading 6",
                                value: 6,
                                description: "Heading 6",
                            },
                        ],
                        default: 1,
                        description:
                            "An optional custom heading size of this section in the report. Must be a valid report heading. Example: 3",
                    },

                    {
                        displayName: "Review status",
                        name: "review_status",
                        type: "options",
                        options: [
                            {
                                name: "Draft",
                                value: 0,
                                description: "Draft",
                            },
                            {
                                name: "Under Review",
                                value: 1,
                                description: "Under Review",
                            },
                            {
                                name: "Revision Requested",
                                value: 3,
                                description: "Revision Requested",
                            },
                            {
                                name: "Approved",
                                value: 2,
                                description: "Approved",
                            },
                        ],
                        default: 0,
                        description:
                            "The current review status of the assessment section. Must be a valid review status. Example: 0",
                    },

                    {
                        displayName: "Is published",
                        name: "is_published",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether or not the section is published. Example: false",
                    },
                ],
            },

            // Assessment Section Comment - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                    },
                },
                options: [
                    {
                        name: "Create an assessment section comment",
                        value: "createAnAssessmentSectionComment",
                        action: "Create an assessment section comment",
                        description:
                            "Create a new assessment section comment. Object information.",
                    },
                    {
                        name: "Update an assessment section comment",
                        value: "updateAnAssessmentSectionComment",
                        action: "Update an assessment section comment",
                        description:
                            "Update an existing assessment section comment. Object information.",
                    },
                ],
                default: "createAnAssessmentSectionComment",
            },

            {
                displayName: "Assessment section id",
                name: "assessment_section_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                        operation: ["createAnAssessmentSectionComment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentsections",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment section. Example: 6f7a357353324676830a6356331c77fa",
            },

            {
                displayName: "Body",
                name: "body",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                        operation: ["createAnAssessmentSectionComment"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The text of the comment. Example: Can you clarify ...",
            },
            {
                displayName: "Is private",
                name: "is_private",
                type: "boolean",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                        operation: ["createAnAssessmentSectionComment"],
                    },
                },
                default: "",
                description:
                    "Whether the comment can be read by clients. Must be true. Example: false",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                        operation: ["createAnAssessmentSectionComment"],
                    },
                },
                options: [
                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                        operation: ["updateAnAssessmentSectionComment"],
                    },
                },
                default: "",
                description:
                    "The ID of the assessment section comment. Example: 88061e837a0242a3b1d7dc40c412f352",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentSectionComment"],
                        operation: ["updateAnAssessmentSectionComment"],
                    },
                },
                options: [
                    {
                        displayName: "Body",
                        name: "body",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The text of the comment. Example: Can you clarify ...",
                    },

                    {
                        displayName: "Is private",
                        name: "is_private",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the comment can be read by clients. Example: false",
                    },
                ],
            },

            // Assessment Task Set - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTaskSet"],
                    },
                },
                options: [
                    {
                        name: "Add a task set to an assessment",
                        value: "addATaskSetToAnAssessment",
                        action: "Add a task set to an assessment",
                        description:
                            "Assign an existing task set's tasks to an assessment.",
                    },
                    {
                        name: "Remove a task set from an assessment",
                        value: "removeATaskSetFromAnAssessment",
                        action: "Remove a task set from an assessment",
                        description:
                            "Remove a task set's tasks from an assessment. This does **not** delete the task set. It just removes its tasks from the assessment.",
                    },
                ],
                default: "addATaskSetToAnAssessment",
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTaskSet"],
                        operation: ["addATaskSetToAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: d9327c1ddcdb4994ad6ac4ddc5bf1abf",
            },

            {
                displayName: "Task set id",
                name: "task_set_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTaskSet"],
                        operation: ["addATaskSetToAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTasksets",
                    loadOptionsDependsOn: ["assessment_id"],
                },
                default: undefined,
                description:
                    "The ID of the task set whose tasks should be assigned to the assessment. The id of an existing record in the task_sets table. Example: 59a415a4a32229eebd4407c6a5b6f2a9",
            },
            {
                displayName: "Assigned users",
                name: "assigned_users",
                type: "fixedCollection",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTaskSet"],
                        operation: ["addATaskSetToAnAssessment"],
                    },
                },
                options: [
                    {
                        name: "items",
                        displayName: "Item",
                        values: [
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description:
                                    'An array of user IDs that should be assigned to those tasks. Example: ["6144002a2cd84c61b6678593837d95dc"]',
                            },
                        ],
                    },
                ],
                typeOptions: {
                    multipleValues: true,
                },
                default: [],
                description:
                    'An array of user IDs that should be assigned to those tasks. Example: ["6144002a2cd84c61b6678593837d95dc"]',
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTaskSet"],
                        operation: ["removeATaskSetFromAnAssessment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 090dece73a73414fb1f5ce2a8d1f51d3",
            },
            {
                displayName: "Id",
                name: "id",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTaskSet"],
                        operation: ["removeATaskSetFromAnAssessment"],
                    },
                },
                default: "",
                description:
                    "The ID of the task set. Example: 8dea8f975c7b40cd97a5376fe575813a",
            },

            // Assessment Template - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTemplate"],
                    },
                },
                options: [
                    {
                        name: "List assessment templates",
                        value: "listAssessmentTemplates",
                        action: "List assessment templates",
                        description:
                            "Retrieve a list of all accessible assessment templates. Object information.",
                    },
                    {
                        name: "Retrieve an assessment template",
                        value: "retrieveAnAssessmentTemplate",
                        action: "Retrieve an assessment template",
                        description:
                            "Retrieve all details of the given assessment template. Object information.",
                    },
                ],
                default: "listAssessmentTemplates",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentTemplate"],
                        operation: ["listAssessmentTemplates"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Name",
                                                value: "name",
                                            },
                                            {
                                                name: "Enabled",
                                                value: "enabled",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentTemplate"],
                        operation: ["retrieveAnAssessmentTemplate"],
                    },
                },
                default: "",
                description:
                    "The ID of the assessment template. Example: 72ab0de4780443c0b1d20b3dc6b327a2",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentTemplate"],
                        operation: ["retrieveAnAssessmentTemplate"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            // Assessment User - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                    },
                },
                options: [
                    {
                        name: "Create an assessment user",
                        value: "createAnAssessmentUser",
                        action: "Create an assessment user",
                        description:
                            "Assign an existing user to an assessment. Object information.",
                    },
                    {
                        name: "Update an assessment user",
                        value: "updateAnAssessmentUser",
                        action: "Update an assessment user",
                        description:
                            "Update assessment-specific values for a user assigned to the assessment. Object information. To update the user's data, such as name and email address, see the User endpoints.",
                    },
                    {
                        name: "Remove an assessment user",
                        value: "removeAnAssessmentUser",
                        action: "Remove an assessment user",
                        description:
                            "Remove a user from an assessment. Object information. A user can not be removed this way if they are assigned to the assessment through a user group. This does **not** delete the user, it just revo...",
                    },
                ],
                default: "createAnAssessmentUser",
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["createAnAssessmentUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: c9d97a13097041709616ddaa4f5971e1",
            },

            {
                displayName: "User id",
                name: "user_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["createAnAssessmentUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadUsers",
                },
                default: undefined,
                description:
                    "The id of the user that should be attached to the assessment. Example: 6144002a2cd84c61b6678593837d95dc",
            },
            {
                displayName: "Type",
                name: "type",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["createAnAssessmentUser"],
                    },
                },
                options: [
                    {
                        name: "Client",
                        value: 0,
                        description: "Client",
                    },
                    {
                        name: "Researcher",
                        value: 1,
                        description: "Researcher",
                    },
                    {
                        name: "Manager",
                        value: 2,
                        description: "Manager",
                    },
                    {
                        name: "Client lead",
                        value: 3,
                        description: "Client lead",
                    },
                    {
                        name: "Lead researcher",
                        value: 4,
                        description: "Lead researcher",
                    },
                    {
                        name: "Manager and lead researcher",
                        value: 5,
                        description: "Manager and lead researcher",
                    },
                ],
                default: 0,
                description:
                    "Whether this assessment user acts as client, research or research manager within the assessment. To assign a user as a client type, they must be attached to the client of the assessment. To assign ...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["createAnAssessmentUser"],
                    },
                },
                options: [
                    {
                        displayName: "Roles",
                        name: "roles",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadRoles",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The assessment role(s) of this researcher user within the posted assessment. This field is only applicable if this user is a researcher or manager. Example: ["researcher"]',
                    },

                    {
                        displayName: "Receives notifications",
                        name: "receives_notifications",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether this client user receives assessment related notification. This field is only applicable if this user is a client. Example: false",
                    },

                    {
                        displayName: "Auto assignments",
                        name: "auto_assignments",
                        type: "options",
                        options: [
                            {
                                name: "Create findings where required",
                                value: 1,
                                description: "Create findings where required",
                            },
                            {
                                name: "Review findings",
                                value: 3,
                                description: "Review findings",
                            },
                            {
                                name: "Perform retests",
                                value: 5,
                                description: "Perform retests",
                            },
                            {
                                name: "Review retests",
                                value: 7,
                                description: "Review retests",
                            },
                            {
                                name: "Answer finding comments from clients",
                                value: 9,
                                description:
                                    "Answer finding comments from clients",
                            },
                            {
                                name: "Manage other assessment statuses",
                                value: 11,
                                description: "Manage other assessment statuses",
                            },
                            {
                                name: 'Set assessment to "Under Review"',
                                value: 15,
                                description: 'Set assessment to "Under Review"',
                            },
                            {
                                name: 'Set assessment to "Review Completed"',
                                value: 16,
                                description:
                                    'Set assessment to "Review Completed"',
                            },
                            {
                                name: "Evaluate Tool Findings",
                                value: 20,
                                description: "Evaluate Tool Findings",
                            },
                            {
                                name: "Evaluate Tool Targets",
                                value: 21,
                                description: "Evaluate Tool Targets",
                            },
                            {
                                name: "Assign resolvers",
                                value: 22,
                                description: "Assign resolvers",
                            },
                            {
                                name: "Answer assessment comments from clients",
                                value: 23,
                                description:
                                    "Answer assessment comments from clients",
                            },
                            {
                                name: "Complete assessment sections",
                                value: 25,
                                description: "Complete assessment sections",
                            },
                            {
                                name: "Review assessment sections",
                                value: 26,
                                description: "Review assessment sections",
                            },
                            {
                                name: "Publish reviewable models",
                                value: 28,
                                description: "Publish reviewable models",
                            },
                            {
                                name: "Test cases",
                                value: 29,
                                description: "Test cases",
                            },
                        ],
                        default: 1,
                        description:
                            "Tasks of the selected types will be assigned to this user. This field is only applicable if this user is a researcher or manager. Must be a valid task type. Example: [17]",
                    },

                    {
                        displayName: "Expires on",
                        name: "expires_on",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An optional date after which this user is no longer able to access the assessment. Expired researcher users will still appear on the report. Must be a valid date. Example: 2026-01-22",
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["updateAnAssessmentUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 7c0566be157f413f9cce3e2f2ff79c8f",
            },
            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["updateAnAssessmentUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentusers",
                    loadOptionsDependsOn: ["assessment_id"],
                },
                default: undefined,
                description:
                    "The ID of the user. Example: 3b082070881048ae81e6c637228446bf",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["updateAnAssessmentUser"],
                    },
                },
                options: [
                    {
                        displayName: "Type",
                        name: "type",
                        type: "options",
                        options: [
                            {
                                name: "Client",
                                value: 0,
                                description: "Client",
                            },
                            {
                                name: "Researcher",
                                value: 1,
                                description: "Researcher",
                            },
                            {
                                name: "Manager",
                                value: 2,
                                description: "Manager",
                            },
                            {
                                name: "Client lead",
                                value: 3,
                                description: "Client lead",
                            },
                            {
                                name: "Lead researcher",
                                value: 4,
                                description: "Lead researcher",
                            },
                            {
                                name: "Manager and lead researcher",
                                value: 5,
                                description: "Manager and lead researcher",
                            },
                        ],
                        default: 0,
                        description:
                            "Whether this assessment user acts as client, research or research manager within the assessment. To assign a user as a client type, they must be attached to the client of the assessment. To assign ...",
                    },

                    {
                        displayName: "Roles",
                        name: "roles",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadRoles",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The assessment role(s) of this researcher user within the posted assessment. This field is only applicable if this user is a researcher or manager. Example: ["researcher"]',
                    },

                    {
                        displayName: "Receives notifications",
                        name: "receives_notifications",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether this client user receives assessment related notification. This field is only applicable if this user is a client. Example: false",
                    },

                    {
                        displayName: "Auto assignments",
                        name: "auto_assignments",
                        type: "options",
                        options: [
                            {
                                name: "Create findings where required",
                                value: 1,
                                description: "Create findings where required",
                            },
                            {
                                name: "Review findings",
                                value: 3,
                                description: "Review findings",
                            },
                            {
                                name: "Perform retests",
                                value: 5,
                                description: "Perform retests",
                            },
                            {
                                name: "Review retests",
                                value: 7,
                                description: "Review retests",
                            },
                            {
                                name: "Answer finding comments from clients",
                                value: 9,
                                description:
                                    "Answer finding comments from clients",
                            },
                            {
                                name: "Manage other assessment statuses",
                                value: 11,
                                description: "Manage other assessment statuses",
                            },
                            {
                                name: 'Set assessment to "Under Review"',
                                value: 15,
                                description: 'Set assessment to "Under Review"',
                            },
                            {
                                name: 'Set assessment to "Review Completed"',
                                value: 16,
                                description:
                                    'Set assessment to "Review Completed"',
                            },
                            {
                                name: "Evaluate Tool Findings",
                                value: 20,
                                description: "Evaluate Tool Findings",
                            },
                            {
                                name: "Evaluate Tool Targets",
                                value: 21,
                                description: "Evaluate Tool Targets",
                            },
                            {
                                name: "Assign resolvers",
                                value: 22,
                                description: "Assign resolvers",
                            },
                            {
                                name: "Answer assessment comments from clients",
                                value: 23,
                                description:
                                    "Answer assessment comments from clients",
                            },
                            {
                                name: "Complete assessment sections",
                                value: 25,
                                description: "Complete assessment sections",
                            },
                            {
                                name: "Review assessment sections",
                                value: 26,
                                description: "Review assessment sections",
                            },
                            {
                                name: "Publish reviewable models",
                                value: 28,
                                description: "Publish reviewable models",
                            },
                            {
                                name: "Test cases",
                                value: 29,
                                description: "Test cases",
                            },
                        ],
                        default: 1,
                        description:
                            "Tasks of the selected types will be assigned to this user. This field is only applicable if this user is a researcher or manager. Must be a valid task type. Example: [18]",
                    },

                    {
                        displayName: "Expires on",
                        name: "expires_on",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An optional date after which this user is no longer able to access the assessment. Expired researcher users will still appear on the report. Must be a valid date. Example: 2026-01-22",
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["removeAnAssessmentUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 7c0566be157f413f9cce3e2f2ff79c8f",
            },
            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["assessmentUser"],
                        operation: ["removeAnAssessmentUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentusers",
                    loadOptionsDependsOn: ["assessment_id"],
                },
                default: undefined,
                description:
                    "The ID of the user. Example: 3b082070881048ae81e6c637228446bf",
            },

            // Client - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["client"],
                    },
                },
                options: [
                    {
                        name: "List clients",
                        value: "listClients",
                        action: "List clients",
                        description:
                            'Retrieve a list of all accessible clients. Object information. To also retrieve the logos of the clients, specify the "documents" relation in the request. See Including Related Data.',
                    },
                    {
                        name: "Create a client",
                        value: "createAClient",
                        action: "Create a client",
                        description:
                            "Create a new client. Object information. To add a logo to a client, attach a document representing the logo to it in a separate request. See Documents.",
                    },
                    {
                        name: "Retrieve a client",
                        value: "retrieveAClient",
                        action: "Retrieve a client",
                        description:
                            'Retrieve all details of the given client. Object information. To also retrieve the logo of the client, specify the "documents" relation in the request. See Including Related Data.',
                    },
                    {
                        name: "Update a client",
                        value: "updateAClient",
                        action: "Update a client",
                        description:
                            "Update an existing client. Object information. To add or replace a logo for a client, create a document for it in a separate request. This will overwrite the existing avatar. See Documents.",
                    },
                ],
                default: "listClients",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["listClients"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Name",
                                                value: "name",
                                            },
                                            {
                                                name: "Website",
                                                value: "website",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Name",
                name: "name",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["createAClient"],
                    },
                },
                default: "",
                description:
                    "The name of the company or organization. Must not be greater than 191 characters. Example: Vulnerabilities Inc",
            },
            {
                displayName: "Description",
                name: "description",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["createAClient"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "A description of the organization (markdown). Example: *Example* is a company that...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["createAClient"],
                    },
                },
                options: [
                    {
                        displayName: "Local short id",
                        name: "local_short_id",
                        type: "string",
                        default: "",
                        description:
                            'Every finding has a unique short ID, such as "R-VI-APP-202201-001" (refer to the general documentation for more information). The local short ID of a client is the second part. It must be unique an...',
                    },

                    {
                        displayName: "Website",
                        name: "website",
                        type: "string",
                        default: "",
                        description:
                            "The client's website. Must not be greater than 191 characters. Example: www.example.com",
                    },

                    {
                        displayName: "Managers",
                        name: "managers",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The account managers for the client. If you don't have permission to see all clients, you will automatically be assigned as manager so you can see the new client. Example: [ \"9dd283daa3c241dca03621...",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Tags to organize clients. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Internal"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Tags to organize clients. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Internal"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["createAClient"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsClient",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["retrieveAClient"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadClients",
                },
                default: undefined,
                description:
                    "The ID of the client. Example: 51c2e69164614ed081e58ca79c5e1cbf",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["retrieveAClient"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["updateAClient"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadClients",
                },
                default: undefined,
                description:
                    "The ID of the client. Example: 51c2e69164614ed081e58ca79c5e1cbf",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["updateAClient"],
                    },
                },
                options: [
                    {
                        displayName: "Name",
                        name: "name",
                        type: "string",
                        default: "",
                        description:
                            "The name of the company or organization. Must not be greater than 191 characters. Example: Vulnerabilities Inc",
                    },

                    {
                        displayName: "Local short id",
                        name: "local_short_id",
                        type: "string",
                        default: "",
                        description:
                            'Every finding has a unique short ID, such as "R-VI-APP-202201-001". The local short ID of a client is the second part. It must be unique and should be recognizable. (In this example VI for the fict...',
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "A description of the organization (markdown). Example: *Example* is a company that...",
                    },

                    {
                        displayName: "Website",
                        name: "website",
                        type: "string",
                        default: "",
                        description:
                            "The client's website. Must not be greater than 191 characters. Example: www.example.com",
                    },

                    {
                        displayName: "Managers",
                        name: "managers",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The account managers for the client. If you don't have permission to see all clients, you will automatically be added to the list, so you don't revoke your own access. Example: [ \"9dd283daa3c241dca...",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Tags to organize clients. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Internal"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Tags to organize clients. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Internal"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["client"],
                        operation: ["updateAClient"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsClient",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },
            // Custom Field - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["customField"],
                    },
                },
                options: [
                    {
                        name: "List custom fields",
                        value: "listCustomFields",
                        action: "List custom fields",
                        description:
                            "Retrieve a lost of all accessible custom fields Object information>.",
                    },
                ],
                default: "listCustomFields",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["customField"],
                        operation: ["listCustomFields"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Model type,index",
                                                value: "model_type,index",
                                            },
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Index",
                                                value: "index",
                                            },
                                            {
                                                name: "Model type",
                                                value: "model_type",
                                            },
                                            {
                                                name: "Name",
                                                value: "name",
                                            },
                                            {
                                                name: "Label",
                                                value: "label",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            // Document - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["document"],
                    },
                },
                options: [
                    {
                        name: "Retrieve a document",
                        value: "retrieveADocument",
                        action: "Retrieve a document",
                        description:
                            "Retrieve the stored file contents of the given document. Object information.",
                    },
                    {
                        name: "Upload a document",
                        value: "uploadADocument",
                        action: "Upload a document",
                        description:
                            "Upload a new (draft) document. Object information. Use `Content-Type: multipart/form-data` for this request.",
                    },
                ],
                default: "retrieveADocument",
            },

            {
                displayName: "Id",
                name: "id",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["document"],
                        operation: ["retrieveADocument"],
                    },
                },
                default: "",
                description:
                    "The ID of the document. Example: d46caf39d4e94b6e93311db14a0edaf2",
            },

            {
                displayName: "Documentable type",
                name: "documentable_type",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["document"],
                        operation: ["uploadADocument"],
                    },
                },
                options: [
                    {
                        name: "Assessment",
                        value: "Assessment",
                        description: "Assessment",
                    },
                    {
                        name: "AssessmentComment",
                        value: "AssessmentComment",
                        description: "AssessmentComment",
                    },
                    {
                        name: "AssessmentSection",
                        value: "AssessmentSection",
                        description: "AssessmentSection",
                    },
                    {
                        name: "AssessmentSectionComment",
                        value: "AssessmentSectionComment",
                        description: "AssessmentSectionComment",
                    },
                    {
                        name: "Client",
                        value: "Client",
                        description: "Client",
                    },
                    {
                        name: "Finding",
                        value: "Finding",
                        description: "Finding",
                    },
                    {
                        name: "FindingComment",
                        value: "FindingComment",
                        description: "FindingComment",
                    },
                    {
                        name: "FindingRetest",
                        value: "FindingRetest",
                        description: "FindingRetest",
                    },
                    {
                        name: "FindingRetestCancelledEvent",
                        value: "FindingRetestCancelledEvent",
                        description: "FindingRetestCancelledEvent",
                    },
                    {
                        name: "FindingRetestInquiry",
                        value: "FindingRetestInquiry",
                        description: "FindingRetestInquiry",
                    },
                    {
                        name: "FindingReviewEvent",
                        value: "FindingReviewEvent",
                        description: "FindingReviewEvent",
                    },
                    {
                        name: "FindingTemplate",
                        value: "FindingTemplate",
                        description: "FindingTemplate",
                    },
                    {
                        name: "Target",
                        value: "Target",
                        description: "Target",
                    },
                    {
                        name: "User",
                        value: "User",
                        description: "User",
                    },
                ],
                default: "Assessment",
                description:
                    "The model type this document belongs to. Example: Finding",
            },
            {
                displayName: "Section",
                name: "section",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["document"],
                        operation: ["uploadADocument"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The section of the associated model the document belongs in, see [here]({{bundle.authData.reporter_url}}/api-documentation#document-resource-section-field) the allowed values. Example: description",
            },
            {
                displayName: "Binary Property",
                name: "file",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["document"],
                        operation: ["uploadADocument"],
                    },
                },
                default: "data",
                description:
                    "Name of the binary property containing the file to upload",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["document"],
                        operation: ["uploadADocument"],
                    },
                },
                options: [
                    {
                        displayName: "Documentable id",
                        name: "documentable_id",
                        type: "string",
                        default: "",
                        description:
                            "The id of the associated model. Must contain only letters and numbers. Example: 3639127a83ad02c3527e9ea1fd69c8c2",
                    },

                    {
                        displayName: "Caption",
                        name: "caption",
                        type: "string",
                        default: "",
                        description:
                            'Used in the markdown snippet as the caption of an image or the title of a document. Not stored in the database. Defaults to "Caption_here" for images and the full file name for other documents. Mus...',
                    },

                    {
                        displayName: "Language id",
                        name: "language_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadLanguages",
                        },
                        default: undefined,
                        description:
                            "The ID of the language for which this file is being added. This is only used when uploading non-draft documents for translatable models (such as finding templates). Defaults to the primary language...",
                    },
                ],
            },

            // Finding - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                    },
                },
                options: [
                    {
                        name: "List findings",
                        value: "listFindings",
                        action: "List findings",
                        description:
                            "Retrieve a list of all accessible findings. Object information.",
                    },
                    {
                        name: "Create a finding",
                        value: "createAFinding",
                        action: "Create a finding",
                        description:
                            "Create a new finding. Object information.",
                    },
                    {
                        name: "Retrieve a finding",
                        value: "retrieveAFinding",
                        action: "Retrieve a finding",
                        description:
                            "Retrieve all details of the given finding. Object information.",
                    },
                    {
                        name: "Update a finding",
                        value: "updateAFinding",
                        action: "Update a finding",
                        description:
                            "Create a new finding. Object information.",
                    },
                    {
                        name: "Create a finding from a template",
                        value: "createAFindingFromATemplate",
                        action: "Create a finding from a template",
                        description:
                            "Create a new finding from a finding template. Object information.",
                    },
                ],
                default: "listFindings",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["listFindings"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Title",
                                                value: "title",
                                            },
                                            {
                                                name: "Severity",
                                                value: "severity",
                                            },
                                            {
                                                name: "Priority",
                                                value: "priority",
                                            },
                                            {
                                                name: "Complexity",
                                                value: "complexity",
                                            },
                                            {
                                                name: "Status",
                                                value: "status",
                                            },
                                            {
                                                name: "Found at",
                                                value: "found_at",
                                            },
                                            {
                                                name: "Reviewed at",
                                                value: "reviewed_at",
                                            },
                                            {
                                                name: "Published at",
                                                value: "published_at",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Resolved at",
                                                value: "resolved_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: a75e5cb991ed4f6ca5c7bee72ed37b51",
            },

            {
                displayName: "Title",
                name: "title",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                default: "",
                description:
                    "Title of the finding. Must not be greater than 191 characters. Example: XSS on login page",
            },
            {
                displayName: "Assessment section id",
                name: "assessment_section_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentsections",
                    loadOptionsDependsOn: ["assessment_id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment section to put the finding in. The section must belong to the assessment, and its can_have_findings must be true. Example: 28f88dcf84b3aac30dab3c84f5d548fe",
            },
            {
                displayName: "Is vulnerability",
                name: "is_vulnerability",
                type: "boolean",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                default: "",
                description:
                    "Whether the finding is for a vulnerability (and has associated severity metrics). Example: true",
            },
            {
                displayName: "Review status",
                name: "review_status",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                options: [
                    {
                        name: "Draft",
                        value: 0,
                        description: "Draft",
                    },
                    {
                        name: "Under Review",
                        value: 1,
                        description: "Under Review",
                    },
                    {
                        name: "Revision Requested",
                        value: 3,
                        description: "Revision Requested",
                    },
                    {
                        name: "Approved",
                        value: 2,
                        description: "Approved",
                    },
                ],
                default: 0,
                description:
                    "The current review status of the finding. Must be a valid review status. Example: 0",
            },
            {
                displayName: "Is published",
                name: "is_published",
                type: "boolean",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                default: "",
                description: "Whether the finding is published. Example: true",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                options: [
                    {
                        displayName: "Tool findings",
                        name: "tool_findings",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadToolfindings",
                            multipleValues: true,
                            loadOptionsDependsOn: ["id"],
                        },
                        default: undefined,
                        description:
                            'IDs of tool findings that should be linked to the newly created finding. Must not be greater than 32 characters. Example: [["f606a7c2d0474f32a50057be56aba9a9"]]',
                    },

                    {
                        displayName: "Severity metrics",
                        name: "severity_metrics",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array with severity values depending on the scoring system, see [here]({{bundle.authData.reporter_url}}/api-documentation#scoring-systems) the possible `severity_metrics` values. Required if is_...",
                    },

                    {
                        displayName: "Severity",
                        name: "severity",
                        type: "options",
                        options: [
                            {
                                name: "Not Applicable",
                                value: 0,
                                description: "Not Applicable",
                            },
                            {
                                name: "Unknown",
                                value: 1,
                                description: "Unknown",
                            },
                            {
                                name: "OK",
                                value: 2,
                                description: "OK",
                            },
                            {
                                name: "False Positive",
                                value: 3,
                                description: "False Positive",
                            },
                        ],
                        default: 0,
                        description:
                            "Required if is_vulnerability is false, determined from severity metrics otherwise. Must be a valid severity. This field is required when is_vulnerability is false or 0. Example: 11",
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Priority",
                        name: "priority",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Low",
                                value: 1,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 3,
                                description: "High",
                            },
                            {
                                name: "Urgent",
                                value: 4,
                                description: "Urgent",
                            },
                        ],
                        default: 0,
                        description:
                            "How urgent resolving this finding is. Must be a valid priority. Example: 3",
                    },

                    {
                        displayName: "Complexity",
                        name: "complexity",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Trivial",
                                value: 1,
                                description: "Trivial",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "Complex",
                                value: 3,
                                description: "Complex",
                            },
                            {
                                name: "Very Complex",
                                value: 4,
                                description: "Very Complex",
                            },
                        ],
                        default: 0,
                        description:
                            "How complex resolving this finding is. Must be a valid complexity. Example: 1",
                    },

                    {
                        displayName: "Action",
                        name: "action",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The recommended action (under 500 characters) to resolve this finding. Must not be greater than 500 characters. Example: Update ...",
                    },

                    {
                        displayName: "Targets",
                        name: "targets",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadTargets",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The IDs of targets the finding applies to. Each target must belong to the assessment. Example: ["59a606a4a32229eebd4407c6a5b6f2a9"]',
                    },

                    {
                        displayName: "Found at",
                        name: "found_at",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Must be a valid date. Example: 2022-12-01T16:13:11+0000",
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: There is ...",
                    },

                    {
                        displayName: "Risk",
                        name: "risk",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: A hacker could ...",
                    },

                    {
                        displayName: "Recommendation",
                        name: "recommendation",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: Update ...",
                    },

                    {
                        displayName: "Proof",
                        name: "proof",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: See attached ...",
                    },

                    {
                        displayName: "References",
                        name: "references",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Example: - `https://owasp.org/Top10/A03_2021-Injection/`\\n - `https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/`",
                    },

                    {
                        displayName: "Classifications",
                        name: "classifications",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array with classifications by classification system. You can use any combination of CWE, CAPEC or VRT classifications. Note that classifications are ignored if their system is not set in the ass...",
                    },

                    {
                        displayName: "Resolvers",
                        name: "resolvers",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: null Properties: []",
                    },

                    {
                        displayName: "User groups",
                        name: "user_groups",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: null Properties: []",
                    },

                    {
                        displayName: "Test cases",
                        name: "test_cases",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadTestcases",
                            multipleValues: true,
                            loadOptionsDependsOn: ["assessment_id"],
                        },
                        default: undefined,
                        description:
                            'The IDs of the test cases that are associated with this finding. Example: ["59a606a4a32229eebd4407c6a5b6f2a9"]',
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFinding"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsFinding",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["retrieveAFinding"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindings",
                },
                default: undefined,
                description:
                    "The ID of the finding. Example: 9df447b636f14992aea27569d3ca0204",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["retrieveAFinding"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["updateAFinding"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindings",
                },
                default: undefined,
                description:
                    "The ID of the finding. Example: 9df447b636f14992aea27569d3ca0204",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["updateAFinding"],
                    },
                },
                options: [
                    {
                        displayName: "Title",
                        name: "title",
                        type: "string",
                        default: "",
                        description:
                            "Title of the finding. Must not be greater than 191 characters. Example: XSS on login page",
                    },

                    {
                        displayName: "Assessment section id",
                        name: "assessment_section_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadAssessmentsections",
                            loadOptionsDependsOn: ["id"],
                        },
                        default: undefined,
                        description:
                            "The ID of the assessment section to put the finding in. The section must belong to the assessment, and its `can_have_findings` must be true. Example: 28f88dcf84b3aac30dab3c84f5d548fe",
                    },

                    {
                        displayName: "Is vulnerability",
                        name: "is_vulnerability",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the finding is for a vulnerability (and has associated severity metrics). Can not be changed if the `status` is Retest Pending. Example: true",
                    },

                    {
                        displayName: "Status",
                        name: "status",
                        type: "options",
                        options: [
                            {
                                name: "Unresolved",
                                value: 0,
                                description: "Unresolved",
                            },
                            {
                                name: "Partially Resolved",
                                value: 4,
                                description: "Partially Resolved",
                            },
                            {
                                name: "Retest Pending",
                                value: 2,
                                description: "Retest Pending",
                            },
                            {
                                name: "Unable to Verify",
                                value: 5,
                                description: "Unable to Verify",
                            },
                            {
                                name: "Accepted Risk",
                                value: 3,
                                description: "Accepted Risk",
                            },
                            {
                                name: "Resolved",
                                value: 1,
                                description: "Resolved",
                            },
                        ],
                        default: 0,
                        description:
                            "The current status of the finding. Can not be changed to or from Retest Pending. Must be a valid finding status. Example: 5",
                    },

                    {
                        displayName: "Resolved targets",
                        name: "resolved_targets",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'The targets for which the finding is resolved. If all targets are resolved, the finding is resolved as well. Example: ["d37ad9384aba4f9596b4e62c7a3e7f26"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'The targets for which the finding is resolved. If all targets are resolved, the finding is resolved as well. Example: ["d37ad9384aba4f9596b4e62c7a3e7f26"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Review status",
                        name: "review_status",
                        type: "options",
                        options: [
                            {
                                name: "Draft",
                                value: 0,
                                description: "Draft",
                            },
                            {
                                name: "Under Review",
                                value: 1,
                                description: "Under Review",
                            },
                            {
                                name: "Revision Requested",
                                value: 3,
                                description: "Revision Requested",
                            },
                            {
                                name: "Approved",
                                value: 2,
                                description: "Approved",
                            },
                        ],
                        default: 0,
                        description:
                            "The current review status of the finding. Must be a valid review status. Example: 0",
                    },

                    {
                        displayName: "Is published",
                        name: "is_published",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the finding is published. Example: true",
                    },

                    {
                        displayName: "Severity metrics",
                        name: "severity_metrics",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array with severity values depending on the scoring system, see [here]({{bundle.authData.reporter_url}}/api-documentation#scoring-systems) the possible `severity_metrics` values. Only if is_vuln...",
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Priority",
                        name: "priority",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Low",
                                value: 1,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 3,
                                description: "High",
                            },
                            {
                                name: "Urgent",
                                value: 4,
                                description: "Urgent",
                            },
                        ],
                        default: 0,
                        description:
                            "How urgent resolving this finding is. Must be a valid priority. Example: 3",
                    },

                    {
                        displayName: "Complexity",
                        name: "complexity",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Trivial",
                                value: 1,
                                description: "Trivial",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "Complex",
                                value: 3,
                                description: "Complex",
                            },
                            {
                                name: "Very Complex",
                                value: 4,
                                description: "Very Complex",
                            },
                        ],
                        default: 0,
                        description:
                            "How complex resolving this finding is. Must be a valid complexity. Example: 1",
                    },

                    {
                        displayName: "Action",
                        name: "action",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The recommended action (under 500 characters) to resolve this finding. Must not be greater than 500 characters. Example: Update ...",
                    },

                    {
                        displayName: "Targets",
                        name: "targets",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadTargets",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The IDs of targets the finding applies to. Each target must belong to the assessment. Example: ["59a606a4a32229eebd4407c6a5b6f2a9"]',
                    },

                    {
                        displayName: "Found at",
                        name: "found_at",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Must be a valid date. Example: 2022-12-01T16:13:11+0000",
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: There is ...",
                    },

                    {
                        displayName: "Risk",
                        name: "risk",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: A hacker could ...",
                    },

                    {
                        displayName: "Recommendation",
                        name: "recommendation",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: Update ...",
                    },

                    {
                        displayName: "Proof",
                        name: "proof",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: See attached ...",
                    },

                    {
                        displayName: "References",
                        name: "references",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Example: - `https://owasp.org/Top10/A03_2021-Injection/`\\n - `https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/`",
                    },

                    {
                        displayName: "Classifications",
                        name: "classifications",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array with classifications by classification system. You can use any combination of CWE, CAPEC or VRT classifications. Note that classifications are ignored if their system is not set in the ass...",
                    },

                    {
                        displayName: "Resolvers",
                        name: "resolvers",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: null Properties: []",
                    },

                    {
                        displayName: "User groups",
                        name: "user_groups",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: null Properties: []",
                    },

                    {
                        displayName: "Test cases",
                        name: "test_cases",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadTestcases",
                            multipleValues: true,
                            loadOptionsDependsOn: ["id"],
                        },
                        default: undefined,
                        description:
                            'The IDs of the test cases that are associated with this finding. Example: ["59a606a4a32229eebd4407c6a5b6f2a9"]',
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["updateAFinding"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsFinding",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFindingFromATemplate"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 9ba28fbf396f47febde7f9c151de2ef7",
            },
            {
                displayName: "Finding template id",
                name: "finding_template_id",
                type: "number",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFindingFromATemplate"],
                    },
                },
                default: "",
                description: "The ID of the finding template. Example: 1",
            },

            {
                displayName: "Assessment section id",
                name: "assessment_section_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFindingFromATemplate"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessmentsections",
                    loadOptionsDependsOn: ["assessment_id"],
                },
                default: undefined,
                description:
                    "The ID of the assessment section to put the finding in. The section must belong to the assessment, and its can_have_findings must be true. Example: 28f88dcf84b3aac30dab3c84f5d548fe",
            },
            {
                displayName: "Targets",
                name: "targets",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFindingFromATemplate"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTargets",
                    multipleValues: true,
                },
                default: undefined,
                description:
                    'The IDs of targets the finding applies to. Each target must belong to the assessment. Example: ["59a606a4a32229eebd4407c6a5b6f2a9"]',
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFindingFromATemplate"],
                    },
                },
                options: [
                    {
                        displayName: "Language id",
                        name: "language_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadLanguages",
                        },
                        default: undefined,
                        description:
                            "The language of the template to use. Defaults to the language of the assessment, if available, or the primary language of the template otherwise. Example: en",
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["finding"],
                        operation: ["createAFindingFromATemplate"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsFinding",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },
            // Finding Layout - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["findingLayout"],
                    },
                },
                options: [
                    {
                        name: "List finding layouts",
                        value: "listFindingLayouts",
                        action: "List finding layouts",
                        description:
                            "Retrieve a list of all finding layouts. Object information.",
                    },
                ],
                default: "listFindingLayouts",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingLayout"],
                        operation: ["listFindingLayouts"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            // Finding Event - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                    },
                },
                options: [
                    {
                        name: "List finding events",
                        value: "listFindingEvents",
                        action: "List finding events",
                        description:
                            "Retrieve a list of all accessible finding events. Object information.",
                    },
                    {
                        name: "Create a finding comment",
                        value: "createAFindingComment",
                        action: "Create a finding comment",
                        description:
                            "Create a new finding comment. Object information. Note that comments added before the publication of the finding are displayed as child comments of the 'created event' of the finding.",
                    },
                    {
                        name: "Update a finding comment",
                        value: "updateAFindingComment",
                        action: "Update a finding comment",
                        description:
                            "Update an existing finding comment. Object information.",
                    },
                    {
                        name: "Create a finding retest",
                        value: "createAFindingRetest",
                        action: "Create a finding retest",
                        description:
                            "Perform a retest. Object information. You can only create a retest if the finding has a retest inquiry that doesn't already have a retest.",
                    },
                    {
                        name: "Update a finding retest",
                        value: "updateAFindingRetest",
                        action: "Update a finding retest",
                        description:
                            "Update an existing finding retest. Object information.",
                    },
                    {
                        name: "Create a finding retest inquiry",
                        value: "createAFindingRetestInquiry",
                        action: "Create a finding retest inquiry",
                        description:
                            "Request a retest. Object information. Creating a new retest inquiry for a finding is not allowed if the status of the finding is set to 'Retest Pending.' The finding status is set to 'Retest Pendin...",
                    },
                    {
                        name: "Update a retest inquiry",
                        value: "updateARetestInquiry",
                        action: "Update a retest inquiry",
                        description:
                            "Update an existing finding retest inquiry. Object information.",
                    },
                    {
                        name: "Create a finding retest cancelled event",
                        value: "createAFindingRetestCancelledEvent",
                        action: "Create a finding retest cancelled event",
                        description:
                            "Cancel a retest request. Object information. You can only cancel a retest if the finding has a retest inquiry that doesn't already have a retest.",
                    },
                    {
                        name: "Update a retest cancelled event",
                        value: "updateARetestCancelledEvent",
                        action: "Update a retest cancelled event",
                        description:
                            "Update an existing finding retest cancelled event. Object information.",
                    },
                ],
                default: "listFindingEvents",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["listFindingEvents"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Finding id",
                                                value: "finding_id",
                                            },
                                            {
                                                name: "Assessment id",
                                                value: "assessment_id",
                                            },
                                            {
                                                name: "User id",
                                                value: "user_id",
                                            },
                                            {
                                                name: "Updated by user id",
                                                value: "updated_by_user_id",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Finding id",
                name: "finding_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingComment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindings",
                },
                default: undefined,
                description:
                    "The ID of the finding. Example: 0d933286c9f34e4896cbfecd7da7e37b",
            },

            {
                displayName: "Body",
                name: "body",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingComment"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The text of the comment. Example: Can you clarify ...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingComment"],
                    },
                },
                options: [
                    {
                        displayName: "Is private",
                        name: "is_private",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the comment can be read by clients. Example: false",
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateAFindingComment"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindingevents",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the finding comment. Example: 1fd250275dd640be9c111e2032f32164",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateAFindingComment"],
                    },
                },
                options: [
                    {
                        displayName: "Body",
                        name: "body",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The text of the comment. Example: Can you clarify ...",
                    },

                    {
                        displayName: "Is private",
                        name: "is_private",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the comment can be read by clients. Example: false",
                    },
                ],
            },

            {
                displayName: "Finding id",
                name: "finding_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetest"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindings",
                },
                default: undefined,
                description:
                    "The ID of the finding. Example: 25488d44f8874a978ac42f6624d13165",
            },

            {
                displayName: "Status",
                name: "status",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetest"],
                    },
                },
                options: [
                    {
                        name: "Unresolved",
                        value: 0,
                        description: "Unresolved",
                    },
                    {
                        name: "Resolved",
                        value: 1,
                        description: "Resolved",
                    },
                    {
                        name: "Accepted Risk",
                        value: 3,
                        description: "Accepted Risk",
                    },
                    {
                        name: "Unable to Verify",
                        value: 5,
                        description: "Unable to Verify",
                    },
                ],
                default: 0,
                description:
                    "The new status of the finding after the retest. Must be a valid finding status. Example: 0",
            },
            {
                displayName: "Body",
                name: "body",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetest"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The text of the retest. Example: The problem has now ...",
            },
            {
                displayName: "Review status",
                name: "review_status",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetest"],
                    },
                },
                options: [
                    {
                        name: "Draft",
                        value: 0,
                        description: "Draft",
                    },
                    {
                        name: "Under Review",
                        value: 1,
                        description: "Under Review",
                    },
                    {
                        name: "Revision Requested",
                        value: 3,
                        description: "Revision Requested",
                    },
                    {
                        name: "Approved",
                        value: 2,
                        description: "Approved",
                    },
                ],
                default: 0,
                description:
                    "Where the retest is in the review process. By default, only reviewers and admins can set the review status to Published. Must be a valid review status. Example: 0",
            },
            {
                displayName: "Is published",
                name: "is_published",
                type: "boolean",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetest"],
                    },
                },
                default: "",
                description:
                    "Whether or not the retest is published. Example: false",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetest"],
                    },
                },
                options: [
                    {
                        displayName: "Resolved targets",
                        name: "resolved_targets",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The target_id of an existing record in the finding_target table. Example: null Properties: []",
                    },

                    {
                        displayName: "Severity",
                        name: "severity",
                        type: "options",
                        options: [
                            {
                                name: "OK",
                                value: 2,
                                description: "OK",
                            },
                            {
                                name: "False Positive",
                                value: 3,
                                description: "False Positive",
                            },
                        ],
                        default: 2,
                        description:
                            "Required if is_vulnerability is false, determined from severity metrics otherwise. Must be a valid severity. Example: 2",
                    },

                    {
                        displayName: "Severity metrics",
                        name: "severity_metrics",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            'An array with severity values depending on the scoring system, see [here]({{bundle.authData.reporter_url}}/api-documentation#scoring-systems) the possible `severity_metrics` values. Example: { "imp...',
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateAFindingRetest"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindingevents",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the finding retest. Example: f65305a466e74c67ba85d8454816577c",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateAFindingRetest"],
                    },
                },
                options: [
                    {
                        displayName: "Status",
                        name: "status",
                        type: "options",
                        options: [
                            {
                                name: "Unresolved",
                                value: 0,
                                description: "Unresolved",
                            },
                            {
                                name: "Resolved",
                                value: 1,
                                description: "Resolved",
                            },
                            {
                                name: "Accepted Risk",
                                value: 3,
                                description: "Accepted Risk",
                            },
                            {
                                name: "Partially Resolved",
                                value: 4,
                                description: "Partially Resolved",
                            },
                            {
                                name: "Unable to Verify",
                                value: 5,
                                description: "Unable to Verify",
                            },
                        ],
                        default: 0,
                        description:
                            "The new status of the finding after the retest. Must be a valid finding status. Example: 0",
                    },

                    {
                        displayName: "Body",
                        name: "body",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The text of the retest. Example: The problem has now ...",
                    },

                    {
                        displayName: "Resolved targets",
                        name: "resolved_targets",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: null Properties: []",
                    },

                    {
                        displayName: "Severity",
                        name: "severity",
                        type: "options",
                        options: [
                            {
                                name: "Not Applicable",
                                value: 0,
                                description: "Not Applicable",
                            },
                            {
                                name: "Unknown",
                                value: 1,
                                description: "Unknown",
                            },
                            {
                                name: "OK",
                                value: 2,
                                description: "OK",
                            },
                            {
                                name: "False Positive",
                                value: 3,
                                description: "False Positive",
                            },
                            {
                                name: "Info",
                                value: 8,
                                description: "Info",
                            },
                            {
                                name: "Low",
                                value: 9,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 10,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 11,
                                description: "High",
                            },
                            {
                                name: "Critical",
                                value: 12,
                                description: "Critical",
                            },
                        ],
                        default: 0,
                        description:
                            "When a retest is marked as 'Resolved', it needs to be categorized as either 'False Positive' or 'OK'. By default, the Reporter classifies a resolved retest as 'OK'. If this classification isn't app...",
                    },

                    {
                        displayName: "Review status",
                        name: "review_status",
                        type: "options",
                        options: [
                            {
                                name: "Draft",
                                value: 0,
                                description: "Draft",
                            },
                            {
                                name: "Under Review",
                                value: 1,
                                description: "Under Review",
                            },
                            {
                                name: "Revision Requested",
                                value: 3,
                                description: "Revision Requested",
                            },
                            {
                                name: "Approved",
                                value: 2,
                                description: "Approved",
                            },
                        ],
                        default: 0,
                        description:
                            "The review status indicates the current stage of the retest in the review process. Using Reporter's default assessment roles, only users with 'reviewer' or 'admin' roles have the permission to chan...",
                    },

                    {
                        displayName: "Is published",
                        name: "is_published",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether or not the retest is published. Example: false",
                    },

                    {
                        displayName: "Severity metrics",
                        name: "severity_metrics",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            'An array with severity values depending on the scoring system, see [here]({{bundle.authData.reporter_url}}/api-documentation#scoring-systems) the possible `severity_metrics` values. Example: { "imp...',
                    },
                ],
            },

            {
                displayName: "Finding id",
                name: "finding_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetestInquiry"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindings",
                },
                default: undefined,
                description:
                    "The ID of the finding. Example: cb118774231d434e9204a76da7cd6772",
            },

            {
                displayName: "Body",
                name: "body",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetestInquiry"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The text of the retest request. Example: Can you confirm that ...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetestInquiry"],
                    },
                },
                options: [
                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateARetestInquiry"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindingevents",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the finding retest inquiry. Example: 8cc333dc39a34f44b4bc45dde9dee7da",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateARetestInquiry"],
                    },
                },
                options: [
                    {
                        displayName: "Body",
                        name: "body",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The text of the retest request. Example: Can you confirm that ...",
                    },
                ],
            },

            {
                displayName: "Finding retest inquiry id",
                name: "finding_retest_inquiry_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetestCancelledEvent"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindingretestinquirys",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the finding retest inquiry. Example: 306d27f5d0e947fdb6309a6ac407873e",
            },

            {
                displayName: "Body",
                name: "body",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetestCancelledEvent"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The text of the retest request. Example: Can you confirm that ...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["createAFindingRetestCancelledEvent"],
                    },
                },
                options: [
                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateARetestCancelledEvent"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadFindingevents",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the finding retest cancelled event. Example: 87cbcba990ab4a2385b78b484c31a4d0",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingEvent"],
                        operation: ["updateARetestCancelledEvent"],
                    },
                },
                options: [
                    {
                        displayName: "Body",
                        name: "body",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The text of the retest cancelled event request. Example: I am cancelling this retest request because ...",
                    },
                ],
            },

            // Finding Template - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                    },
                },
                options: [
                    {
                        name: "Search finding templates",
                        value: "searchFindingTemplates",
                        action: "Search finding templates",
                        description:
                            'Search for finding templates. It is not possible to include relations or filter the search. Object information. If a search term is submitted and neither "prefer_language" nor "language_id" are, th...',
                    },
                    {
                        name: "List finding templates",
                        value: "listFindingTemplates",
                        action: "List finding templates",
                        description:
                            "Retrieve a list of all accessible finding templates. Object information.",
                    },
                    {
                        name: "Create a finding template",
                        value: "createAFindingTemplate",
                        action: "Create a finding template",
                        description:
                            "Create a new finding template. Object information.",
                    },
                    {
                        name: "Retrieve a finding template",
                        value: "retrieveAFindingTemplate",
                        action: "Retrieve a finding template",
                        description:
                            "Retrieve all details of the given finding. Object information.",
                    },
                    {
                        name: "Update a finding template",
                        value: "updateAFindingTemplate",
                        action: "Update a finding template",
                        description:
                            "Update an existing finding template. Object information. Only custom finding templates (`source`: 0) can be updated.",
                    },
                ],
                default: "searchFindingTemplates",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["searchFindingTemplates"],
                    },
                },
                options: [
                    {
                        displayName: "Term",
                        name: "term",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The search term. Example: Cross-site scripting.",
                    },

                    {
                        displayName: "Source",
                        name: "source",
                        type: "options",
                        options: [
                            {
                                name: "Custom",
                                value: 0,
                                description: "Custom",
                            },
                            {
                                name: "Burp Suite",
                                value: 1,
                                description: "Burp Suite",
                            },
                            {
                                name: "VulnDB",
                                value: 2,
                                description: "VulnDB",
                            },
                            {
                                name: "Acunetix",
                                value: 3,
                                description: "Acunetix",
                            },
                        ],
                        default: 0,
                        description:
                            "Only return templates from the selected source. Must be a valid finding template source. Example: 0",
                    },

                    {
                        displayName: "Severity",
                        name: "severity",
                        type: "options",
                        options: [
                            {
                                name: "Not Applicable",
                                value: 0,
                                description: "Not Applicable",
                            },
                            {
                                name: "Unknown",
                                value: 1,
                                description: "Unknown",
                            },
                            {
                                name: "OK",
                                value: 2,
                                description: "OK",
                            },
                            {
                                name: "False Positive",
                                value: 3,
                                description: "False Positive",
                            },
                            {
                                name: "Info",
                                value: 8,
                                description: "Info",
                            },
                            {
                                name: "Low",
                                value: 9,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 10,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 11,
                                description: "High",
                            },
                            {
                                name: "Critical",
                                value: 12,
                                description: "Critical",
                            },
                        ],
                        default: 0,
                        description:
                            "Only include templates with these severities. Must be a valid severity. Example: [11]",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description: 'Filter by tags. Example: ["XSS"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Filter by tags. Example: ["XSS"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Prefer language",
                        name: "prefer_language",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Boosts results in the selected language and translates the model into that language if available. Example: en",
                    },

                    {
                        displayName: "Language id",
                        name: "language_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadLanguages",
                        },
                        default: undefined,
                        description:
                            "Only return templates that have been translated into the selected language and return results in that language. Example: en",
                    },
                ],
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["listFindingTemplates"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Severity",
                                                value: "severity",
                                            },
                                            {
                                                name: "Priority",
                                                value: "priority",
                                            },
                                            {
                                                name: "Complexity",
                                                value: "complexity",
                                            },
                                            {
                                                name: "Title",
                                                value: "title",
                                            },
                                            {
                                                name: "Source",
                                                value: "source",
                                            },
                                            {
                                                name: "Weight",
                                                value: "weight",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Title",
                name: "title",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["createAFindingTemplate"],
                    },
                },
                default: "",
                description:
                    "Title of the template finding. Must not be greater than 191 characters. Example: XSS on login page",
            },
            {
                displayName: "Is vulnerability",
                name: "is_vulnerability",
                type: "boolean",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["createAFindingTemplate"],
                    },
                },
                default: "",
                description:
                    "Whether the template finding is for a vulnerability (and has associated severity metrics). Example: true",
            },
            {
                displayName: "Description",
                name: "description",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["createAFindingTemplate"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description: "Example: There is ...",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["createAFindingTemplate"],
                    },
                },
                options: [
                    {
                        displayName: "Primary language id",
                        name: "primary_language_id",
                        type: "string",
                        default: "",
                        description:
                            "The primary language of the template. Optional if there is only one. Example: en",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Tags to organize finding templates. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Tags to organize finding templates. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Severity metrics all",
                        name: "severity_metrics_all",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array whose keys are scoring systems and whose values are metrics for these scoring systems. See [here]({{bundle.authData.reporter_url}}/api-documentation#scoring-systems) the possible metrics f...",
                    },

                    {
                        displayName: "Severity",
                        name: "severity",
                        type: "options",
                        options: [
                            {
                                name: "Not Applicable",
                                value: 0,
                                description: "Not Applicable",
                            },
                            {
                                name: "Unknown",
                                value: 1,
                                description: "Unknown",
                            },
                            {
                                name: "OK",
                                value: 2,
                                description: "OK",
                            },
                            {
                                name: "False Positive",
                                value: 3,
                                description: "False Positive",
                            },
                        ],
                        default: 0,
                        description:
                            "Required if is_vulnerability is false, determined from severity metrics otherwise. Must be a valid severity. This field is required when is_vulnerability is false or 0. Example: 4",
                    },

                    {
                        displayName: "Classifications",
                        name: "classifications",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array with classifications by classification system. You can use any combination of CWE, CAPEC or VRT classifications. Note that classifications are ignored if their system is not set in the ass...",
                    },

                    {
                        displayName: "Priority",
                        name: "priority",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Low",
                                value: 1,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 3,
                                description: "High",
                            },
                            {
                                name: "Urgent",
                                value: 4,
                                description: "Urgent",
                            },
                        ],
                        default: 0,
                        description:
                            "How urgent resolving this finding is. Must be a valid priority. Example: 3",
                    },

                    {
                        displayName: "Complexity",
                        name: "complexity",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Trivial",
                                value: 1,
                                description: "Trivial",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "Complex",
                                value: 3,
                                description: "Complex",
                            },
                            {
                                name: "Very Complex",
                                value: 4,
                                description: "Very Complex",
                            },
                        ],
                        default: 0,
                        description:
                            "How complex resolving this finding is. Must be a valid complexity. Example: 1",
                    },

                    {
                        displayName: "Action",
                        name: "action",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The recommended action (under 500 characters) to resolve this finding. Must not be greater than 500 characters. Example: Update ...",
                    },

                    {
                        displayName: "Risk",
                        name: "risk",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: A hacker could ...",
                    },

                    {
                        displayName: "Recommendation",
                        name: "recommendation",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: Update ...",
                    },

                    {
                        displayName: "Proof",
                        name: "proof",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: See attached ...",
                    },

                    {
                        displayName: "References",
                        name: "references",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: OWASP A03:2021 ...",
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["createAFindingTemplate"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsFinding",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "number",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["retrieveAFindingTemplate"],
                    },
                },
                default: "",
                description: "The ID of the finding template. Example: 1",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["retrieveAFindingTemplate"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "number",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["updateAFindingTemplate"],
                    },
                },
                default: "",
                description: "The ID of the finding template. Example: 1",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["updateAFindingTemplate"],
                    },
                },
                options: [
                    {
                        displayName: "Language id",
                        name: "language_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadLanguages",
                        },
                        default: undefined,
                        description:
                            "The translation language to update. Defaults to the primary language of the template. If a translation for the given language does not exist, a translation will be created. Any documents from the p...",
                    },

                    {
                        displayName: "Primary language id",
                        name: "primary_language_id",
                        type: "string",
                        default: "",
                        description:
                            "Set the translation language as the primary language. Example: en",
                    },

                    {
                        displayName: "Title",
                        name: "title",
                        type: "string",
                        default: "",
                        description:
                            "Title of the template finding. Must not be greater than 191 characters. Example: XSS on login page",
                    },

                    {
                        displayName: "Tags",
                        name: "tags",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Tags to organize finding templates. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Tags to organize finding templates. Tags are not case sensitive. Must not be greater than 191 characters. Example: ["Mobile"]',
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Is vulnerability",
                        name: "is_vulnerability",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the template finding is for a vulnerability (and has associated severity metrics). Example: true",
                    },

                    {
                        displayName: "Severity metrics all",
                        name: "severity_metrics_all",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array whose keys are scoring systems and whose values are metrics for these scoring systems. See [here]({{bundle.authData.reporter_url}}/api-documentation#scoring-systems) the possible metrics f...",
                    },

                    {
                        displayName: "Severity",
                        name: "severity",
                        type: "options",
                        options: [
                            {
                                name: "Not Applicable",
                                value: 0,
                                description: "Not Applicable",
                            },
                            {
                                name: "Unknown",
                                value: 1,
                                description: "Unknown",
                            },
                            {
                                name: "OK",
                                value: 2,
                                description: "OK",
                            },
                            {
                                name: "False Positive",
                                value: 3,
                                description: "False Positive",
                            },
                        ],
                        default: 0,
                        description:
                            "Required if is_vulnerability is false, determined from severity metrics otherwise. Must be a valid severity. This field is required when is_vulnerability is false or 0. Example: 2",
                    },

                    {
                        displayName: "Classifications",
                        name: "classifications",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "An array with classifications by classification system. You can use any combination of CWE, CAPEC or VRT classifications. Note that classifications are ignored if their system is not set in the ass...",
                    },

                    {
                        displayName: "Priority",
                        name: "priority",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Low",
                                value: 1,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 3,
                                description: "High",
                            },
                            {
                                name: "Urgent",
                                value: 4,
                                description: "Urgent",
                            },
                        ],
                        default: 0,
                        description:
                            "How urgent resolving this finding is. Must be a valid priority. Example: 3",
                    },

                    {
                        displayName: "Complexity",
                        name: "complexity",
                        type: "options",
                        options: [
                            {
                                name: "Unknown",
                                value: 0,
                                description: "Unknown",
                            },
                            {
                                name: "Trivial",
                                value: 1,
                                description: "Trivial",
                            },
                            {
                                name: "Medium",
                                value: 2,
                                description: "Medium",
                            },
                            {
                                name: "Complex",
                                value: 3,
                                description: "Complex",
                            },
                            {
                                name: "Very Complex",
                                value: 4,
                                description: "Very Complex",
                            },
                        ],
                        default: 0,
                        description:
                            "How complex resolving this finding is. Must be a valid complexity. Example: 1",
                    },

                    {
                        displayName: "Action",
                        name: "action",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The recommended action (under 500 characters) to resolve this finding. Must not be greater than 500 characters. Example: Update ...",
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: There is ...",
                    },

                    {
                        displayName: "Risk",
                        name: "risk",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: A hacker could ...",
                    },

                    {
                        displayName: "Recommendation",
                        name: "recommendation",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: Update ...",
                    },

                    {
                        displayName: "Proof",
                        name: "proof",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: See attached ...",
                    },

                    {
                        displayName: "References",
                        name: "references",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "Example: OWASP A03:2021 ...",
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["findingTemplate"],
                        operation: ["updateAFindingTemplate"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsFinding",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },
            // Language - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["language"],
                    },
                },
                options: [
                    {
                        name: "List languages",
                        value: "listLanguages",
                        action: "List languages",
                        description:
                            "Retrieve a list of all languages. Object information.",
                    },
                ],
                default: "listLanguages",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["language"],
                        operation: ["listLanguages"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Name",
                                                value: "name",
                                            },
                                            {
                                                name: "Language",
                                                value: "language",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Is assessment report default",
                                                value: "is_assessment_report_default",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            // Output File - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["outputFile"],
                    },
                },
                options: [
                    {
                        name: "Upload an output file to parse",
                        value: "uploadAnOutputFileToParse",
                        action: "Upload an output file to parse",
                        description:
                            "Create a new output file. Object information. Once created, the file will be parsed in the background.",
                    },
                    {
                        name: "List output files",
                        value: "listOutputFiles",
                        action: "List output files",
                        description:
                            "Retrieve a list of all output files. Object information.",
                    },
                ],
                default: "uploadAnOutputFileToParse",
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["outputFile"],
                        operation: ["uploadAnOutputFileToParse"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: deff319400cb4e119e1310d651505ebe",
            },

            {
                displayName: "Name",
                name: "name",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["outputFile"],
                        operation: ["uploadAnOutputFileToParse"],
                    },
                },
                default: "",
                description:
                    "A descriptive name for the file. Must not be greater than 191 characters. Example: Burp scan 5/25",
            },
            {
                displayName: "Binary Property",
                name: "file",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["outputFile"],
                        operation: ["uploadAnOutputFileToParse"],
                    },
                },
                default: "data",
                description:
                    "Name of the binary property containing the file to upload",
            },
            {
                displayName: "Tool",
                name: "tool",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["outputFile"],
                        operation: ["uploadAnOutputFileToParse"],
                    },
                },
                options: [
                    {
                        name: "42Crunch",
                        value: "crunch42",
                        description: "42Crunch",
                    },
                    {
                        name: "Acunetix",
                        value: "acunetix",
                        description: "Acunetix",
                    },
                    {
                        name: "Anchore-Engine",
                        value: "anchore_engine",
                        description: "Anchore-Engine",
                    },
                    {
                        name: "AnchoreCTL Policies",
                        value: "anchorectl_policies",
                        description: "AnchoreCTL Policies",
                    },
                    {
                        name: "AnchoreCTL Vulns",
                        value: "anchorectl_vulns",
                        description: "AnchoreCTL Vulns",
                    },
                    {
                        name: "Anchore Enterprise",
                        value: "anchore_enterprise",
                        description: "Anchore Enterprise",
                    },
                    {
                        name: "Anchore Grype",
                        value: "anchore_grype",
                        description: "Anchore Grype",
                    },
                    {
                        name: "AppCheck Web Application Scanner",
                        value: "appcheck_web_application_scanner",
                        description: "AppCheck Web Application Scanner",
                    },
                    {
                        name: "AppSpider",
                        value: "appspider",
                        description: "AppSpider",
                    },
                    {
                        name: "Aqua",
                        value: "aqua",
                        description: "Aqua",
                    },
                    {
                        name: "Arachni",
                        value: "arachni",
                        description: "Arachni",
                    },
                    {
                        name: "AuditJs",
                        value: "auditjs",
                        description: "AuditJs",
                    },
                    {
                        name: "AWS Inspector2",
                        value: "aws_inspector2",
                        description: "AWS Inspector2",
                    },
                    {
                        name: "AWS Prowler",
                        value: "aws_prowler",
                        description: "AWS Prowler",
                    },
                    {
                        name: "AWS Prowler v3",
                        value: "aws_prowler_v3plus",
                        description: "AWS Prowler v3",
                    },
                    {
                        name: "AWS Security Finding Format (ASFF)",
                        value: "asff",
                        description: "AWS Security Finding Format (ASFF)",
                    },
                    {
                        name: "AWS Security Hub",
                        value: "awssecurityhub",
                        description: "AWS Security Hub",
                    },
                    {
                        name: "Azure Security Center Recommendations",
                        value: "azure_security_center_recommendations",
                        description: "Azure Security Center Recommendations",
                    },
                    {
                        name: "Bandit",
                        value: "bandit",
                        description: "Bandit",
                    },
                    {
                        name: "Bearer CLI",
                        value: "bearer_cli",
                        description: "Bearer CLI",
                    },
                    {
                        name: "Black Duck",
                        value: "blackduck",
                        description: "Black Duck",
                    },
                    {
                        name: "Black Duck API",
                        value: "api_blackduck",
                        description: "Black Duck API",
                    },
                    {
                        name: "Black Duck Binary Analysis",
                        value: "blackduck_binary_analysis",
                        description: "Black Duck Binary Analysis",
                    },
                    {
                        name: "Black Duck Component Risk",
                        value: "blackduck_component_risk",
                        description: "Black Duck Component Risk",
                    },
                    {
                        name: "Brakeman",
                        value: "brakeman",
                        description: "Brakeman",
                    },
                    {
                        name: "Bugcrowd",
                        value: "bugcrowd",
                        description: "Bugcrowd",
                    },
                    {
                        name: "Bugcrowd API",
                        value: "api_bugcrowd",
                        description: "Bugcrowd API",
                    },
                    {
                        name: "Bundler Audit",
                        value: "bundler_audit",
                        description: "Bundler Audit",
                    },
                    {
                        name: "Burp Dastardly",
                        value: "burp_dastardly",
                        description: "Burp Dastardly",
                    },
                    {
                        name: "Burp Enterprise",
                        value: "burp_suite_dast",
                        description: "Burp Enterprise",
                    },
                    {
                        name: "Burp GraphQL",
                        value: "burp_graphql",
                        description: "Burp GraphQL",
                    },
                    {
                        name: "Burp GraphQL API",
                        value: "burp_api",
                        description: "Burp GraphQL API",
                    },
                    {
                        name: "Burp XML",
                        value: "burp",
                        description: "Burp XML",
                    },
                    {
                        name: "CargoAudit",
                        value: "cargo_audit",
                        description: "CargoAudit",
                    },
                    {
                        name: "Checkmarx",
                        value: "checkmarx",
                        description: "Checkmarx",
                    },
                    {
                        name: "Checkmarx CxFlow SAST",
                        value: "checkmarx_cxflow_sast",
                        description: "Checkmarx CxFlow SAST",
                    },
                    {
                        name: "Checkmarx One",
                        value: "checkmarx_one",
                        description: "Checkmarx One",
                    },
                    {
                        name: "Checkmarx OSA",
                        value: "checkmarx_osa",
                        description: "Checkmarx OSA",
                    },
                    {
                        name: "Checkov",
                        value: "checkov",
                        description: "Checkov",
                    },
                    {
                        name: "Chef InSpec",
                        value: "chefinspect",
                        description: "Chef InSpec",
                    },
                    {
                        name: "Clair",
                        value: "clair",
                        description: "Clair",
                    },
                    {
                        name: "CloudSploit (AquaSecurity)",
                        value: "cloudsploit",
                        description: "CloudSploit (AquaSecurity)",
                    },
                    {
                        name: "Cobalt.io",
                        value: "cobalt",
                        description: "Cobalt.io",
                    },
                    {
                        name: "Cobalt API Import",
                        value: "api_cobalt",
                        description: "Cobalt API Import",
                    },
                    {
                        name: "CodeChecker",
                        value: "codechecker",
                        description: "CodeChecker",
                    },
                    {
                        name: "Contrast",
                        value: "contrast",
                        description: "Contrast",
                    },
                    {
                        name: "Coverity API",
                        value: "coverity_api",
                        description: "Coverity API",
                    },
                    {
                        name: "Coverity Scan JSON Report",
                        value: "coverity_scan",
                        description: "Coverity Scan JSON Report",
                    },
                    {
                        name: "Crashtest Security",
                        value: "crashtest_security",
                        description: "Crashtest Security",
                    },
                    {
                        name: "CredScan",
                        value: "cred_scan",
                        description: "CredScan",
                    },
                    {
                        name: "Cyberwatch Galeax",
                        value: "cyberwatch_galeax",
                        description: "Cyberwatch Galeax",
                    },
                    {
                        name: "CycloneDX",
                        value: "cyclonedx",
                        description: "CycloneDX",
                    },
                    {
                        name: "Cycognito",
                        value: "cycognito",
                        description: "Cycognito",
                    },
                    {
                        name: "DawnScanner",
                        value: "dawnscanner",
                        description: "DawnScanner",
                    },
                    {
                        name: "Deepfence Threatmapper",
                        value: "deepfence_threatmapper",
                        description: "Deepfence Threatmapper",
                    },
                    {
                        name: "DefectDojo Generic",
                        value: "generic",
                        description: "DefectDojo Generic",
                    },
                    {
                        name: "Dependency-Check (OWASP)",
                        value: "dependency_check",
                        description: "Dependency-Check (OWASP)",
                    },
                    {
                        name: "Dependency-Track (OWASP)",
                        value: "dependency_track",
                        description: "Dependency-Track (OWASP)",
                    },
                    {
                        name: "Detect-secrets (Yelp)",
                        value: "detect_secrets",
                        description: "Detect-secrets (Yelp)",
                    },
                    {
                        name: "Docker Bench for Security",
                        value: "dockerbench",
                        description: "Docker Bench for Security",
                    },
                    {
                        name: "Dockle",
                        value: "dockle",
                        description: "Dockle",
                    },
                    {
                        name: "DrHeader",
                        value: "drheader",
                        description: "DrHeader",
                    },
                    {
                        name: "DSOP",
                        value: "dsop",
                        description: "DSOP",
                    },
                    {
                        name: "Edgescan API",
                        value: "api_edgescan",
                        description: "Edgescan API",
                    },
                    {
                        name: "ESLint",
                        value: "eslint",
                        description: "ESLint",
                    },
                    {
                        name: "Fortify",
                        value: "fortify",
                        description: "Fortify",
                    },
                    {
                        name: "GitGuardian ggshield",
                        value: "ggshield",
                        description: "GitGuardian ggshield",
                    },
                    {
                        name: "GitHub SAST",
                        value: "github_sast",
                        description: "GitHub SAST",
                    },
                    {
                        name: "GitHub Secrets Detection Report",
                        value: "github_secrets_detection_report",
                        description: "GitHub Secrets Detection Report",
                    },
                    {
                        name: "GitHub Vulnerability",
                        value: "github_vulnerability",
                        description: "GitHub Vulnerability",
                    },
                    {
                        name: "GitLab API Fuzzing",
                        value: "gitlab_api_fuzzing",
                        description: "GitLab API Fuzzing",
                    },
                    {
                        name: "GitLab Container Scan",
                        value: "gitlab_container_scan",
                        description: "GitLab Container Scan",
                    },
                    {
                        name: "GitLab DAST",
                        value: "gitlab_dast",
                        description: "GitLab DAST",
                    },
                    {
                        name: "GitLab Dependency Scan",
                        value: "gitlab_dep_scan",
                        description: "GitLab Dependency Scan",
                    },
                    {
                        name: "GitLab SAST",
                        value: "gitlab_sast",
                        description: "GitLab SAST",
                    },
                    {
                        name: "GitLab Secret Detection Report",
                        value: "gitlab_secret_detection_report",
                        description: "GitLab Secret Detection Report",
                    },
                    {
                        name: "Gitleaks",
                        value: "gitleaks",
                        description: "Gitleaks",
                    },
                    {
                        name: "Google Cloud Artifact Scan",
                        value: "gcloud_artifact_scan",
                        description: "Google Cloud Artifact Scan",
                    },
                    {
                        name: "Gosec Scanner",
                        value: "gosec",
                        description: "Gosec Scanner",
                    },
                    {
                        name: "govulnscan",
                        value: "govulncheck",
                        description: "govulnscan",
                    },
                    {
                        name: "HackerOne",
                        value: "h1",
                        description: "HackerOne",
                    },
                    {
                        name: "Hadolint",
                        value: "hadolint",
                        description: "Hadolint",
                    },
                    {
                        name: "Harbor Vulnerability",
                        value: "harbor_vulnerability",
                        description: "Harbor Vulnerability",
                    },
                    {
                        name: "HCL AppScan",
                        value: "hcl_appscan",
                        description: "HCL AppScan",
                    },
                    {
                        name: "HCL ASoC SAST",
                        value: "hcl_asoc_sast",
                        description: "HCL ASoC SAST",
                    },
                    {
                        name: "Horusec",
                        value: "horusec",
                        description: "Horusec",
                    },
                    {
                        name: "Humble",
                        value: "humble",
                        description: "Humble",
                    },
                    {
                        name: "huskyCI",
                        value: "huskyci",
                        description: "huskyCI",
                    },
                    {
                        name: "Hydra",
                        value: "hydra",
                        description: "Hydra",
                    },
                    {
                        name: "IBM AppScan DAST",
                        value: "ibm_app",
                        description: "IBM AppScan DAST",
                    },
                    {
                        name: "Immuniweb",
                        value: "immuniweb",
                        description: "Immuniweb",
                    },
                    {
                        name: "IntSights",
                        value: "intsights",
                        description: "IntSights",
                    },
                    {
                        name: "Invicti",
                        value: "invicti",
                        description: "Invicti",
                    },
                    {
                        name: "JFrog Xray",
                        value: "jfrogxray",
                        description: "JFrog Xray",
                    },
                    {
                        name: "JFrog Xray API Summary Artifact",
                        value: "jfrog_xray_api_summary_artifact",
                        description: "JFrog Xray API Summary Artifact",
                    },
                    {
                        name: "JFrog Xray On-Demand Binary Scan",
                        value: "jfrog_xray_on_demand_binary_scan",
                        description: "JFrog Xray On-Demand Binary Scan",
                    },
                    {
                        name: "JFrog Xray Unified",
                        value: "jfrog_xray_unified",
                        description: "JFrog Xray Unified",
                    },
                    {
                        name: "KICS",
                        value: "kics",
                        description: "KICS",
                    },
                    {
                        name: "Kiuwan",
                        value: "kiuwan",
                        description: "Kiuwan",
                    },
                    {
                        name: "Kiuwan SCA",
                        value: "kiuwan_sca",
                        description: "Kiuwan SCA",
                    },
                    {
                        name: "KrakenD Audit",
                        value: "krakend_audit",
                        description: "KrakenD Audit",
                    },
                    {
                        name: "Kube-bench",
                        value: "kubebench",
                        description: "Kube-bench",
                    },
                    {
                        name: "kube-hunter",
                        value: "kubehunter",
                        description: "kube-hunter",
                    },
                    {
                        name: "kubeaudit",
                        value: "kubeaudit",
                        description: "kubeaudit",
                    },
                    {
                        name: "Kubescape",
                        value: "kubescape",
                        description: "Kubescape",
                    },
                    {
                        name: "Legitify",
                        value: "legitify",
                        description: "Legitify",
                    },
                    {
                        name: "Mayhem",
                        value: "mayhem",
                        description: "Mayhem",
                    },
                    {
                        name: "Mend",
                        value: "mend",
                        description: "Mend",
                    },
                    {
                        name: "Meterian",
                        value: "meterian",
                        description: "Meterian",
                    },
                    {
                        name: "Micro Focus WebInspect",
                        value: "microfocus_webinspect",
                        description: "Micro Focus WebInspect",
                    },
                    {
                        name: "Microsoft Defender",
                        value: "ms_defender",
                        description: "Microsoft Defender",
                    },
                    {
                        name: "MobSF",
                        value: "mobsf",
                        description: "MobSF",
                    },
                    {
                        name: "MobSF Scorecard",
                        value: "mobsf_scorecard",
                        description: "MobSF Scorecard",
                    },
                    {
                        name: "Mozilla Observatory",
                        value: "mozilla_observatory",
                        description: "Mozilla Observatory",
                    },
                    {
                        name: "Nancy",
                        value: "nancy",
                        description: "Nancy",
                    },
                    {
                        name: "Netsparker",
                        value: "netsparker",
                        description: "Netsparker",
                    },
                    {
                        name: "NeuVector",
                        value: "neuvector",
                        description: "NeuVector",
                    },
                    {
                        name: "NeuVector Compliance",
                        value: "neuvector_compliance",
                        description: "NeuVector Compliance",
                    },
                    {
                        name: "Nexpose XML 2.0 (Rapid7)",
                        value: "nexpose",
                        description: "Nexpose XML 2.0 (Rapid7)",
                    },
                    {
                        name: "Nikto",
                        value: "nikto",
                        description: "Nikto",
                    },
                    {
                        name: "Nmap",
                        value: "nmap",
                        description: "Nmap",
                    },
                    {
                        name: "Node Security Platform",
                        value: "nsp",
                        description: "Node Security Platform",
                    },
                    {
                        name: "Nosey Parker",
                        value: "noseyparker",
                        description: "Nosey Parker",
                    },
                    {
                        name: "NPM Audit",
                        value: "npm_audit",
                        description: "NPM Audit",
                    },
                    {
                        name: "NPM Audit (v7+)",
                        value: "npm_audit_7_plus",
                        description: "NPM Audit (v7+)",
                    },
                    {
                        name: "Nuclei",
                        value: "nuclei",
                        description: "Nuclei",
                    },
                    {
                        name: "OpenSCAP",
                        value: "openscap",
                        description: "OpenSCAP",
                    },
                    {
                        name: "OpenVAS",
                        value: "openvas",
                        description: "OpenVAS",
                    },
                    {
                        name: "OssIndex Devaudit",
                        value: "ossindex_devaudit",
                        description: "OssIndex Devaudit",
                    },
                    {
                        name: "Oss Review Toolkit",
                        value: "ort",
                        description: "Oss Review Toolkit",
                    },
                    {
                        name: "OSV-Scanner",
                        value: "osv_scanner",
                        description: "OSV-Scanner",
                    },
                    {
                        name: "Outpost24",
                        value: "outpost24",
                        description: "Outpost24",
                    },
                    {
                        name: "PHP Security Audit v2",
                        value: "php_security_audit_v2",
                        description: "PHP Security Audit v2",
                    },
                    {
                        name: "PHP Symfony Security Check",
                        value: "php_symfony_security_check",
                        description: "PHP Symfony Security Check",
                    },
                    {
                        name: "pip-audit",
                        value: "pip_audit",
                        description: "pip-audit",
                    },
                    {
                        name: "PMD",
                        value: "pmd",
                        description: "PMD",
                    },
                    {
                        name: "Popeye",
                        value: "popeye",
                        description: "Popeye",
                    },
                    {
                        name: "Progpilot",
                        value: "progpilot",
                        description: "Progpilot",
                    },
                    {
                        name: "PTART",
                        value: "ptart",
                        description: "PTART",
                    },
                    {
                        name: "PWN Security Automation Framework",
                        value: "pwn_sast",
                        description: "PWN Security Automation Framework",
                    },
                    {
                        name: "Qualys",
                        value: "qualys",
                        description: "Qualys",
                    },
                    {
                        name: "Qualys Hacker Guardian",
                        value: "qualys_hacker_guardian",
                        description: "Qualys Hacker Guardian",
                    },
                    {
                        name: "Qualys InfraScan WebGUI",
                        value: "qualys_infrascan_webgui",
                        description: "Qualys InfraScan WebGUI",
                    },
                    {
                        name: "Qualys Web App",
                        value: "qualys_webapp",
                        description: "Qualys Web App",
                    },
                    {
                        name: "Rapplex Scan",
                        value: "rapplex",
                        description: "Rapplex Scan",
                    },
                    {
                        name: "Red Hat Satellite",
                        value: "redhatsatellite",
                        description: "Red Hat Satellite",
                    },
                    {
                        name: "RetireJS",
                        value: "retirejs",
                        description: "RetireJS",
                    },
                    {
                        name: "ReversingLabs SpectraAssure",
                        value: "reversinglabs_spectraassure",
                        description: "ReversingLabs SpectraAssure",
                    },
                    {
                        name: "RiskRecon API Importer",
                        value: "risk_recon",
                        description: "RiskRecon API Importer",
                    },
                    {
                        name: "RuboCop",
                        value: "rubocop",
                        description: "RuboCop",
                    },
                    {
                        name: "Rusty Hog",
                        value: "rusty_hog",
                        description: "Rusty Hog",
                    },
                    {
                        name: "SARIF",
                        value: "sarif",
                        description: "SARIF",
                    },
                    {
                        name: "Scantist",
                        value: "scantist",
                        description: "Scantist",
                    },
                    {
                        name: "ScoutSuite",
                        value: "scout_suite",
                        description: "ScoutSuite",
                    },
                    {
                        name: "Security Knowledge Framework",
                        value: "skf",
                        description: "Security Knowledge Framework",
                    },
                    {
                        name: "Semgrep JSON",
                        value: "semgrep",
                        description: "Semgrep JSON",
                    },
                    {
                        name: "Semgrep Pro",
                        value: "semgrep_pro",
                        description: "Semgrep Pro",
                    },
                    {
                        name: "Snyk",
                        value: "snyk",
                        description: "Snyk",
                    },
                    {
                        name: "Snyk Code",
                        value: "snyk_code",
                        description: "Snyk Code",
                    },
                    {
                        name: "Snyk Issue API",
                        value: "snyk_issue_api",
                        description: "Snyk Issue API",
                    },
                    {
                        name: "Solar appScreener",
                        value: "solar_appscreener",
                        description: "Solar appScreener",
                    },
                    {
                        name: "SonarQube",
                        value: "sonarqube",
                        description: "SonarQube",
                    },
                    {
                        name: "Sonatype",
                        value: "sonatype",
                        description: "Sonatype",
                    },
                    {
                        name: "SpotBugs",
                        value: "spotbugs",
                        description: "SpotBugs",
                    },
                    {
                        name: "ssh-audit",
                        value: "ssh_audit",
                        description: "ssh-audit",
                    },
                    {
                        name: "SSL Labs",
                        value: "ssl_labs",
                        description: "SSL Labs",
                    },
                    {
                        name: "SSLScan",
                        value: "sslscan",
                        description: "SSLScan",
                    },
                    {
                        name: "SSLyze",
                        value: "sslyze",
                        description: "SSLyze",
                    },
                    {
                        name: "StackHawk",
                        value: "stackhawk",
                        description: "StackHawk",
                    },
                    {
                        name: "Sysdig CLI",
                        value: "sysdig_cli",
                        description: "Sysdig CLI",
                    },
                    {
                        name: "Sysdig Reports",
                        value: "sysdig_reports",
                        description: "Sysdig Reports",
                    },
                    {
                        name: "Talisman",
                        value: "talisman",
                        description: "Talisman",
                    },
                    {
                        name: "Tenable (formerly Nessus)",
                        value: "tenable",
                        description: "Tenable (formerly Nessus)",
                    },
                    {
                        name: "Terrascan",
                        value: "terrascan",
                        description: "Terrascan",
                    },
                    {
                        name: "Testssl",
                        value: "testssl",
                        description: "Testssl",
                    },
                    {
                        name: "Tfsec",
                        value: "tfsec",
                        description: "Tfsec",
                    },
                    {
                        name: "Threagile",
                        value: "threagile",
                        description: "Threagile",
                    },
                    {
                        name: "Threat Composer",
                        value: "threat_composer",
                        description: "Threat Composer",
                    },
                    {
                        name: "Trivy",
                        value: "trivy",
                        description: "Trivy",
                    },
                    {
                        name: "Trivy Operator",
                        value: "trivy_operator",
                        description: "Trivy Operator",
                    },
                    {
                        name: "TruffleHog",
                        value: "trufflehog",
                        description: "TruffleHog",
                    },
                    {
                        name: "TruffleHog3",
                        value: "trufflehog3",
                        description: "TruffleHog3",
                    },
                    {
                        name: "Trustwave",
                        value: "trustwave",
                        description: "Trustwave",
                    },
                    {
                        name: "Trustwave Fusion API",
                        value: "trustwave_fusion_api",
                        description: "Trustwave Fusion API",
                    },
                    {
                        name: "Twistlock",
                        value: "twistlock",
                        description: "Twistlock",
                    },
                    {
                        name: "Veracode",
                        value: "veracode",
                        description: "Veracode",
                    },
                    {
                        name: "Veracode SCA",
                        value: "veracode_sca",
                        description: "Veracode SCA",
                    },
                    {
                        name: "Visual Code Grepper (VCG)",
                        value: "vcg",
                        description: "Visual Code Grepper (VCG)",
                    },
                    {
                        name: "Vulners API",
                        value: "api_vulners",
                        description: "Vulners API",
                    },
                    {
                        name: "Wapiti",
                        value: "wapiti",
                        description: "Wapiti",
                    },
                    {
                        name: "Wazuh",
                        value: "wazuh",
                        description: "Wazuh",
                    },
                    {
                        name: "Wfuzz",
                        value: "wfuzz",
                        description: "Wfuzz",
                    },
                    {
                        name: "Whispers",
                        value: "whispers",
                        description: "Whispers",
                    },
                    {
                        name: "WhiteHat Sentinel",
                        value: "whitehat_sentinel",
                        description: "WhiteHat Sentinel",
                    },
                    {
                        name: "Wiz",
                        value: "wiz",
                        description: "Wiz",
                    },
                    {
                        name: "Wiz-cli Dir Scanner",
                        value: "wizcli_dir",
                        description: "Wiz-cli Dir Scanner",
                    },
                    {
                        name: "Wiz-cli IaC Scanner",
                        value: "wizcli_iac",
                        description: "Wiz-cli IaC Scanner",
                    },
                    {
                        name: "Wiz-cli Img Scanner",
                        value: "wizcli_img",
                        description: "Wiz-cli Img Scanner",
                    },
                    {
                        name: "WPScan",
                        value: "wpscan",
                        description: "WPScan",
                    },
                    {
                        name: "Xanitizer",
                        value: "xanitizer",
                        description: "Xanitizer",
                    },
                    {
                        name: "Xeol",
                        value: "xeol",
                        description: "Xeol",
                    },
                    {
                        name: "Yarn Audit",
                        value: "yarn_audit",
                        description: "Yarn Audit",
                    },
                    {
                        name: "Zed Attack Proxy",
                        value: "zap",
                        description: "Zed Attack Proxy",
                    },
                ],
                default: "crunch42",
                description:
                    "The tool that created the file. Must be a valid importable tool. Must not be one of api_sonarqube. Example: ad",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["outputFile"],
                        operation: ["listOutputFiles"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Assessment template name",
                                                value: "assessment_template_name",
                                            },
                                            {
                                                name: "Status",
                                                value: "status",
                                            },
                                            {
                                                name: "Title",
                                                value: "title",
                                            },
                                            {
                                                name: "Completed date",
                                                value: "completed_date",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            // Tool Finding - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["toolFinding"],
                    },
                },
                options: [
                    {
                        name: "List tool findings",
                        value: "listToolFindings",
                        action: "List tool findings",
                        description:
                            "Retrieve a list of all tool findings. Object information.",
                    },
                    {
                        name: "Retrieve a tool finding",
                        value: "retrieveAToolFinding",
                        action: "Retrieve a tool finding",
                        description:
                            "Retrieve all details of the given tool finding. Object information.",
                    },
                    {
                        name: "Update a tool finding",
                        value: "updateAToolFinding",
                        action: "Update a tool finding",
                        description:
                            "Update an existing tool finding. Object information.",
                    },
                ],
                default: "listToolFindings",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["toolFinding"],
                        operation: ["listToolFindings"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Title",
                                                value: "title",
                                            },
                                            {
                                                name: "Severity",
                                                value: "severity",
                                            },
                                            {
                                                name: "Import status",
                                                value: "import_status",
                                            },
                                            {
                                                name: "Status",
                                                value: "status",
                                            },
                                            {
                                                name: "Date",
                                                value: "date",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["toolFinding"],
                        operation: ["retrieveAToolFinding"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadToolfindings",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the tool finding. Example: 111108505b7c434e90f0daa3ce8f6f66",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["toolFinding"],
                        operation: ["retrieveAToolFinding"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["toolFinding"],
                        operation: ["updateAToolFinding"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadToolfindings",
                    loadOptionsDependsOn: ["finding_id"],
                },
                default: undefined,
                description:
                    "The ID of the tool finding. Example: 111108505b7c434e90f0daa3ce8f6f66",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["toolFinding"],
                        operation: ["updateAToolFinding"],
                    },
                },
                options: [
                    {
                        displayName: "Import status",
                        name: "import_status",
                        type: "options",
                        options: [
                            {
                                name: "Pending",
                                value: 0,
                                description: "Pending",
                            },
                            {
                                name: "Ignored",
                                value: 1,
                                description: "Ignored",
                            },
                            {
                                name: "Linked to finding",
                                value: 2,
                                description: "Linked to finding",
                            },
                        ],
                        default: 0,
                        description:
                            "The import status of the tool finding. Must be a valid import status. Example: 2",
                    },

                    {
                        displayName: "Comment",
                        name: "comment",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "A comment of the tool finding. Must not be greater than 65535 characters. Example: This is a comment.",
                    },

                    {
                        displayName: "Finding id",
                        name: "finding_id",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadFindings",
                        },
                        default: undefined,
                        description:
                            "A finding ID only has to be provided when the import status is also set to linked to a finding. Example: 7662299759094c718a278e6fc74d9ecc",
                    },
                ],
            },

            // Tool Target - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["toolTarget"],
                    },
                },
                options: [
                    {
                        name: "List tool targets",
                        value: "listToolTargets",
                        action: "List tool targets",
                        description:
                            "Retrieve a list of all tool targets. Object information.",
                    },
                    {
                        name: "Update a tool target",
                        value: "updateAToolTarget",
                        action: "Update a tool target",
                        description:
                            "Update the given tool target. Object information.",
                    },
                ],
                default: "listToolTargets",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["toolTarget"],
                        operation: ["listToolTargets"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["toolTarget"],
                        operation: ["updateAToolTarget"],
                    },
                },
                default: "",
                description:
                    "The ID of the tool target. Example: a1e81caf31e141afb3e38af0f20b2b56",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["toolTarget"],
                        operation: ["updateAToolTarget"],
                    },
                },
                options: [
                    {
                        displayName: "Target confirmed",
                        name: "target_confirmed",
                        type: "boolean",
                        default: "",
                        description:
                            "When a tool target is created, the target id is set if it is matched with a target with an identical or similar URL or IP address. To confirm it was matched correctly this field has to be set to tr...",
                    },

                    {
                        displayName: "In scope",
                        name: "in_scope",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the tool target is in scope. Example: false",
                    },
                ],
            },

            // Reaction - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["reaction"],
                    },
                },
                options: [
                    {
                        name: "Create a reaction",
                        value: "createAReaction",
                        action: "Create a reaction",
                        description:
                            "Adds a reaction to the provided model, if that reaction does not exist for the current user. Object information.",
                    },
                ],
                default: "createAReaction",
            },

            {
                displayName: "Model type",
                name: "model_type",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["reaction"],
                        operation: ["createAReaction"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "The model type this reaction belongs to. Example: AssessmentEvent",
            },
            {
                displayName: "Model id",
                name: "model_id",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["reaction"],
                        operation: ["createAReaction"],
                    },
                },
                default: "",
                description:
                    "The id of the model this reaction belongs to. Example: 6144002a2cd84c61b6678593837d95dc",
            },
            {
                displayName: "Reaction",
                name: "reaction",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["reaction"],
                        operation: ["createAReaction"],
                    },
                },
                typeOptions: {
                    rows: 4,
                },
                default: "",
                description:
                    "A unicode emoji. Checks if the provided string is a single emoji. Example: ",
            },

            // Role - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["role"],
                    },
                },
                options: [
                    {
                        name: "List global roles",
                        value: "listGlobalRoles",
                        action: "List global roles",
                        description:
                            "Retrieve a list of global roles. Object information.",
                    },
                    {
                        name: "List assessment roles",
                        value: "listAssessmentRoles",
                        action: "List assessment roles",
                        description:
                            "Retrieve a list of assessment roles. Object information.",
                    },
                ],
                default: "listGlobalRoles",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["role"],
                        operation: ["listGlobalRoles"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["role"],
                        operation: ["listAssessmentRoles"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            // Target - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["target"],
                    },
                },
                options: [
                    {
                        name: "List targets",
                        value: "listTargets",
                        action: "List targets",
                        description:
                            "Retrieve a list of all accessible targets. Object information.",
                    },
                    {
                        name: "Create a target",
                        value: "createATarget",
                        action: "Create a target",
                        description: "Create a new target. Object information.",
                    },
                    {
                        name: "Retrieve a target",
                        value: "retrieveATarget",
                        action: "Retrieve a target",
                        description:
                            "Retrieve all details of the given target. Object information.",
                    },
                    {
                        name: "Update a target",
                        value: "updateATarget",
                        action: "Update a target",
                        description:
                            "Update an existing target. Object information.",
                    },
                ],
                default: "listTargets",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["listTargets"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["createATarget"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: 20eef2f39cc448079934bdc94ba9e83a",
            },

            {
                displayName: "Target type",
                name: "target_type",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["createATarget"],
                    },
                },
                options: [
                    {
                        name: "Server",
                        value: 0,
                        description: "Server",
                    },
                    {
                        name: "Website",
                        value: 1,
                        description: "Website",
                    },
                    {
                        name: "API",
                        value: 2,
                        description: "API",
                    },
                    {
                        name: "iOS",
                        value: 3,
                        description: "iOS",
                    },
                    {
                        name: "Android",
                        value: 4,
                        description: "Android",
                    },
                    {
                        name: "IoT",
                        value: 5,
                        description: "IoT",
                    },
                    {
                        name: "Other",
                        value: 6,
                        description: "Other",
                    },
                    {
                        name: "Account",
                        value: 7,
                        description: "Account",
                    },
                    {
                        name: "Desktop",
                        value: 8,
                        description: "Desktop",
                    },
                    {
                        name: "Laptop",
                        value: 9,
                        description: "Laptop",
                    },
                    {
                        name: "Mobile",
                        value: 10,
                        description: "Mobile",
                    },
                    {
                        name: "Tablet",
                        value: 11,
                        description: "Tablet",
                    },
                    {
                        name: "Router",
                        value: 12,
                        description: "Router",
                    },
                    {
                        name: "Switch",
                        value: 13,
                        description: "Switch",
                    },
                    {
                        name: "Firewall",
                        value: 14,
                        description: "Firewall",
                    },
                    {
                        name: "ICS",
                        value: 15,
                        description: "ICS",
                    },
                    {
                        name: "Kiosk",
                        value: 16,
                        description: "Kiosk",
                    },
                    {
                        name: "Cloud",
                        value: 17,
                        description: "Cloud",
                    },
                    {
                        name: "Wireless Network",
                        value: 18,
                        description: "Wireless Network",
                    },
                    {
                        name: "Physical",
                        value: 19,
                        description: "Physical",
                    },
                    {
                        name: "Company",
                        value: 20,
                        description: "Company",
                    },
                    {
                        name: "Department",
                        value: 21,
                        description: "Department",
                    },
                    {
                        name: "Organization",
                        value: 22,
                        description: "Organization",
                    },
                    {
                        name: "Camera",
                        value: 23,
                        description: "Camera",
                    },
                    {
                        name: "Gameplay",
                        value: 24,
                        description: "Gameplay",
                    },
                    {
                        name: "Smart Contract",
                        value: 25,
                        description: "Smart Contract",
                    },
                    {
                        name: "Web3 Application",
                        value: 26,
                        description: "Web3 Application",
                    },
                    {
                        name: "Source Code",
                        value: 27,
                        description: "Source Code",
                    },
                    {
                        name: "Network",
                        value: 28,
                        description: "Network",
                    },
                ],
                default: 0,
                description:
                    "The type of target. Must be a valid target type. Example: 7",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["createATarget"],
                    },
                },
                options: [
                    {
                        displayName: "Tool target id",
                        name: "tool_target_id",
                        type: "string",
                        default: "",
                        description:
                            "The ID of the tool target to import. If the tool target has a host, the name will be set to the host, unless another name is provided. Must not be greater than 32 characters. Example: f606a7c2d0474...",
                    },

                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "A short description of the target. Example:",
                    },

                    {
                        displayName: "Description url",
                        name: "description_url",
                        type: "string",
                        default: "",
                        description:
                            "A url attached to the description. Must be a valid URL. Must not be greater than 191 characters. Example: https://www.example.com",
                    },

                    {
                        displayName: "Business impact",
                        name: "business_impact",
                        type: "options",
                        options: [
                            {
                                name: "Low",
                                value: 0,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 1,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 2,
                                description: "High",
                            },
                        ],
                        default: 0,
                        description:
                            "The importance of the target to the business. Must be a valid business impact. Example: 1",
                    },

                    {
                        displayName: "Name",
                        name: "name",
                        type: "string",
                        default: "",
                        description:
                            "The name of the target. Must not be greater than 191 characters. Example: Production",
                    },

                    {
                        displayName: "Name url",
                        name: "name_url",
                        type: "string",
                        default: "",
                        description:
                            "The url attached to the target's name. Must be a valid URL. Must not be greater than 191 characters. Example: https://www.example.com",
                    },

                    {
                        displayName: "Ip information",
                        name: "ip_information",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "A comma-separated list of ips associated with the target. Must not be greater than 65535 characters. Example: 1.1.1.1,2.2.2.2,3.3.3.3",
                    },

                    {
                        displayName: "Details",
                        name: "details",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Any details researchers or clients should know about the target (markdown). Example: dolore",
                    },

                    {
                        displayName: "Credentials",
                        name: "credentials",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Credentials needed to test the target (markdown). Example: Username: [copy]admin[/copy]. Password: [copy]0451[/copy]",
                    },

                    {
                        displayName: "Draft documents",
                        name: "draft_documents",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Item",
                        description:
                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description:
                                            'Document IDs of uploaded draft documents. Example: ["f606a7c2d0474f32a50057be56aba9a9"]',
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["retrieveATarget"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTargets",
                },
                default: undefined,
                description:
                    "The ID of the target. Example: f26cc627c4844619a4c440ff00e49b95",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["retrieveATarget"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["updateATarget"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTargets",
                },
                default: undefined,
                description:
                    "The ID of the target. Example: f26cc627c4844619a4c440ff00e49b95",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["target"],
                        operation: ["updateATarget"],
                    },
                },
                options: [
                    {
                        displayName: "Description",
                        name: "description",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "A short description of the target. Example:",
                    },

                    {
                        displayName: "Description url",
                        name: "description_url",
                        type: "string",
                        default: "",
                        description:
                            "A url attached to the description. Must be a valid URL. Must not be greater than 191 characters. Example: https://www.example.com",
                    },

                    {
                        displayName: "Target type",
                        name: "target_type",
                        type: "options",
                        options: [
                            {
                                name: "Server",
                                value: 0,
                                description: "Server",
                            },
                            {
                                name: "Website",
                                value: 1,
                                description: "Website",
                            },
                            {
                                name: "API",
                                value: 2,
                                description: "API",
                            },
                            {
                                name: "iOS",
                                value: 3,
                                description: "iOS",
                            },
                            {
                                name: "Android",
                                value: 4,
                                description: "Android",
                            },
                            {
                                name: "IoT",
                                value: 5,
                                description: "IoT",
                            },
                            {
                                name: "Other",
                                value: 6,
                                description: "Other",
                            },
                            {
                                name: "Account",
                                value: 7,
                                description: "Account",
                            },
                            {
                                name: "Desktop",
                                value: 8,
                                description: "Desktop",
                            },
                            {
                                name: "Laptop",
                                value: 9,
                                description: "Laptop",
                            },
                            {
                                name: "Mobile",
                                value: 10,
                                description: "Mobile",
                            },
                            {
                                name: "Tablet",
                                value: 11,
                                description: "Tablet",
                            },
                            {
                                name: "Router",
                                value: 12,
                                description: "Router",
                            },
                            {
                                name: "Switch",
                                value: 13,
                                description: "Switch",
                            },
                            {
                                name: "Firewall",
                                value: 14,
                                description: "Firewall",
                            },
                            {
                                name: "ICS",
                                value: 15,
                                description: "ICS",
                            },
                            {
                                name: "Kiosk",
                                value: 16,
                                description: "Kiosk",
                            },
                            {
                                name: "Cloud",
                                value: 17,
                                description: "Cloud",
                            },
                            {
                                name: "Wireless Network",
                                value: 18,
                                description: "Wireless Network",
                            },
                            {
                                name: "Physical",
                                value: 19,
                                description: "Physical",
                            },
                            {
                                name: "Company",
                                value: 20,
                                description: "Company",
                            },
                            {
                                name: "Department",
                                value: 21,
                                description: "Department",
                            },
                            {
                                name: "Organization",
                                value: 22,
                                description: "Organization",
                            },
                            {
                                name: "Camera",
                                value: 23,
                                description: "Camera",
                            },
                            {
                                name: "Gameplay",
                                value: 24,
                                description: "Gameplay",
                            },
                            {
                                name: "Smart Contract",
                                value: 25,
                                description: "Smart Contract",
                            },
                            {
                                name: "Web3 Application",
                                value: 26,
                                description: "Web3 Application",
                            },
                            {
                                name: "Source Code",
                                value: 27,
                                description: "Source Code",
                            },
                            {
                                name: "Network",
                                value: 28,
                                description: "Network",
                            },
                        ],
                        default: 0,
                        description:
                            "The type of target. Must be a valid target type. Example: 14",
                    },

                    {
                        displayName: "Business impact",
                        name: "business_impact",
                        type: "options",
                        options: [
                            {
                                name: "Low",
                                value: 0,
                                description: "Low",
                            },
                            {
                                name: "Medium",
                                value: 1,
                                description: "Medium",
                            },
                            {
                                name: "High",
                                value: 2,
                                description: "High",
                            },
                        ],
                        default: 0,
                        description:
                            "The importance of the target to the business. Must be a valid business impact. Example: 2",
                    },

                    {
                        displayName: "Name",
                        name: "name",
                        type: "string",
                        default: "",
                        description:
                            "The name of the target. Must not be greater than 191 characters. Example: Production",
                    },

                    {
                        displayName: "Name url",
                        name: "name_url",
                        type: "string",
                        default: "",
                        description:
                            "The url attached to the target's name. Must be a valid URL. Must not be greater than 191 characters. Example: https://www.example.com",
                    },

                    {
                        displayName: "Ip information",
                        name: "ip_information",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "A comma-separated list of ips associated with the target. Must not be greater than 65535 characters. Example: 1.1.1.1,2.2.2.2,3.3.3.3",
                    },

                    {
                        displayName: "Details",
                        name: "details",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Any details researchers or clients should know about the target (markdown). Example: dolorem",
                    },

                    {
                        displayName: "Credentials",
                        name: "credentials",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Credentials needed to test the target (markdown). Example: Username: [copy]admin[/copy]. Password: [copy]0451[/copy]",
                    },
                ],
            },

            // Task - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                    },
                },
                options: [
                    {
                        name: "List tasks",
                        value: "listTasks",
                        action: "List tasks",
                        description:
                            "Retrieve a list of all tasks. Object information.",
                    },
                    {
                        name: "Retrieve a task",
                        value: "retrieveATask",
                        action: "Retrieve a task",
                        description:
                            "Retrieve all details of the given task. Object information.",
                    },
                    {
                        name: "Update a task",
                        value: "updateATask",
                        action: "Update a task",
                        description:
                            "Update an existing task. Object information.",
                    },
                    {
                        name: "Create a task",
                        value: "createATask",
                        action: "Create a task",
                        description: "Create a new task. Object information.",
                    },
                ],
                default: "listTasks",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["listTasks"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Weight",
                                                value: "weight",
                                            },
                                            {
                                                name: "Deadline",
                                                value: "deadline",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["retrieveATask"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTasks",
                },
                default: undefined,
                description:
                    "The ID of the task. Example: c6350dacb0d64b5caa31381d550c8f2a",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["retrieveATask"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["updateATask"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTasks",
                },
                default: undefined,
                description:
                    "The ID of the task. Example: c6350dacb0d64b5caa31381d550c8f2a",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["updateATask"],
                    },
                },
                options: [
                    {
                        displayName: "Deadline type",
                        name: "deadline_type",
                        type: "options",
                        options: [
                            {
                                name: "Before research starts",
                                value: 0,
                                description: "Before research starts",
                            },
                            {
                                name: "Research deadline",
                                value: 1,
                                description: "Research deadline",
                            },
                            {
                                name: "Review deadline",
                                value: 2,
                                description: "Review deadline",
                            },
                            {
                                name: "Delivery date",
                                value: 3,
                                description: "Delivery date",
                            },
                            {
                                name: "Custom deadline",
                                value: 4,
                                description: "Custom deadline",
                            },
                            {
                                name: "None",
                                value: 5,
                                description: "None",
                            },
                            {
                                name: "Per Task",
                                value: 6,
                                description: "Per Task",
                            },
                            {
                                name: "Research Review",
                                value: 7,
                                description: "Research Review",
                            },
                        ],
                        default: 0,
                        description:
                            "The type of deadline for this task. Must be a valid deadline type. Example: 2",
                    },

                    {
                        displayName: "Deadline change",
                        name: "deadline_change",
                        type: "number",
                        typeOptions: {
                            minValue: -365,
                            maxValue: 365,
                        },
                        default: "",
                        description:
                            "The number of business day a specific task deadline is offset with, depending on the deadline type. Description of what the rule does Must be at least -365. Must not be greater than 365. Example: 4",
                    },

                    {
                        displayName: "Deadline",
                        name: "deadline",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            'The deadline for this task. Only used if the deadline type is "Custom". This field is required when deadline_type is 4. Must be a valid date. Example: 2020-11-19',
                    },

                    {
                        displayName: "Weight",
                        name: "weight",
                        type: "number",
                        typeOptions: {
                            minValue: 1,
                            maxValue: 65535,
                        },
                        default: "",
                        description:
                            "The weight given to a task signifying its importance. Must be at least 1. Must not be greater than 65535. Example: 1",
                    },

                    {
                        displayName: "Data",
                        name: "data",
                        type: "string",
                        default: "",
                        description:
                            'An array consisting of a title and description for the task. Example: { "title": "Task Title", "description": "Task Description"} Properties: { "title": { "type": "string", "description": "Must not...',
                    },

                    {
                        displayName: "Completed",
                        name: "completed",
                        type: "boolean",
                        default: "",
                        description:
                            "Whether the task should become completed. Example: true",
                    },

                    {
                        displayName: "Users",
                        name: "users",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadUsers",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'An array with user IDs to which the task is assigned to. Example: ["59a406a4a32229eebd4407c6a5b6f2a9"]',
                    },
                ],
            },

            {
                displayName: "Assessment id",
                name: "assessment_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["createATask"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadAssessments",
                },
                default: undefined,
                description:
                    "The ID of the assessment. Example: d73488a4bfc241fcb8ab6b63ebb0957c",
            },

            {
                displayName: "Data",
                name: "data",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["createATask"],
                    },
                },
                default: "",
                description:
                    'An array consisting of a title and description for the task. Example: { "title": "Task Title", "description": "Task Description"} Properties: { "title": { "type": "string", "description": "Must not...',
            },
            {
                displayName: "Deadline type",
                name: "deadline_type",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["createATask"],
                    },
                },
                options: [
                    {
                        name: "Before research starts",
                        value: 0,
                        description: "Before research starts",
                    },
                    {
                        name: "Research deadline",
                        value: 1,
                        description: "Research deadline",
                    },
                    {
                        name: "Review deadline",
                        value: 2,
                        description: "Review deadline",
                    },
                    {
                        name: "Delivery date",
                        value: 3,
                        description: "Delivery date",
                    },
                    {
                        name: "Custom deadline",
                        value: 4,
                        description: "Custom deadline",
                    },
                    {
                        name: "None",
                        value: 5,
                        description: "None",
                    },
                    {
                        name: "Per Task",
                        value: 6,
                        description: "Per Task",
                    },
                    {
                        name: "Research Review",
                        value: 7,
                        description: "Research Review",
                    },
                ],
                default: 0,
                description:
                    "The type of deadline for this task. Must be a valid deadline type. Example: 2",
            },
            {
                displayName: "Weight",
                name: "weight",
                type: "number",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["createATask"],
                    },
                },
                typeOptions: {
                    minValue: 1,
                    maxValue: 65535,
                },
                default: "",
                description:
                    "The weight given to a task signifying its importance. Must be at least 1. Must not be greater than 65535. Example: 1",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["task"],
                        operation: ["createATask"],
                    },
                },
                options: [
                    {
                        displayName: "Deadline change",
                        name: "deadline_change",
                        type: "number",
                        typeOptions: {
                            minValue: -365,
                            maxValue: 365,
                        },
                        default: "",
                        description:
                            "The number of business day a specific task deadline is offset with, depending on the deadline type. Must be at least -365. Must not be greater than 365. Example: 4",
                    },

                    {
                        displayName: "Deadline",
                        name: "deadline",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            'The deadline for this task. Only used if the deadline type is "Custom". This field is required when deadline_type is 4. Must be a valid date. Example: 2020-11-19',
                    },

                    {
                        displayName: "Users",
                        name: "users",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadUsers",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'An array with user IDs to which the task is assigned to. Example: ["59a406a4a32229eebd4407c6a5b6f2a9"]',
                    },
                ],
            },

            // Task Set - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                    },
                },
                options: [
                    {
                        name: "List task sets",
                        value: "listTaskSets",
                        action: "List task sets",
                        description:
                            "Retrieve a list of all task sets. Object information.",
                    },
                    {
                        name: "Create a task set",
                        value: "createATaskSet",
                        action: "Create a task set",
                        description:
                            "Create a new task set. Object information.",
                    },
                    {
                        name: "Retrieve a task set",
                        value: "retrieveATaskSet",
                        action: "Retrieve a task set",
                        description:
                            "Retrieve all details of the given task set. Object information.",
                    },
                    {
                        name: "Update a task set",
                        value: "updateATaskSet",
                        action: "Update a task set",
                        description:
                            "Update an existing task set. Object information.",
                    },
                ],
                default: "listTaskSets",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["listTaskSets"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Name",
                name: "name",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["createATaskSet"],
                    },
                },
                default: "",
                description:
                    "The name of the task set. Must not be greater than 191 characters. Example: Task Set Name",
            },
            {
                displayName: "Deadline type",
                name: "deadline_type",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["createATaskSet"],
                    },
                },
                options: [
                    {
                        name: "Before research starts",
                        value: 0,
                        description: "Before research starts",
                    },
                    {
                        name: "Research deadline",
                        value: 1,
                        description: "Research deadline",
                    },
                    {
                        name: "Review deadline",
                        value: 2,
                        description: "Review deadline",
                    },
                    {
                        name: "Delivery date",
                        value: 3,
                        description: "Delivery date",
                    },
                    {
                        name: "None",
                        value: 5,
                        description: "None",
                    },
                    {
                        name: "Per Task",
                        value: 6,
                        description: "Per Task",
                    },
                ],
                default: 0,
                description:
                    "The deadline type of this task set. Must be a valid deadline type. Example: 11",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["createATaskSet"],
                    },
                },
                options: [
                    {
                        displayName: "Deadline change",
                        name: "deadline_change",
                        type: "number",
                        typeOptions: {
                            minValue: -365,
                            maxValue: 365,
                        },
                        default: "",
                        description:
                            "The number of business day a specific task set deadline is offset with, depending on the deadline type. Must be at least -365. Must not be greater than 365. Example: 20",
                    },

                    {
                        displayName: "Tasks",
                        name: "tasks",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Title",
                                        name: "title",
                                        type: "string",
                                        default: "",
                                        description:
                                            "Must not be greater than 191 characters.",
                                    },
                                    {
                                        displayName: "Description",
                                        name: "description",
                                        type: "string",
                                        default: "",
                                        description: "",
                                    },
                                    {
                                        displayName: "Weight",
                                        name: "weight",
                                        type: "number",
                                        typeOptions: {
                                            minValue: 1,
                                            maxValue: 65535,
                                        },
                                        default: 1,
                                        description:
                                            "Must be at least 1. Must not be greater than 65535.",
                                    },
                                    {
                                        displayName: "Deadline Type",
                                        name: "deadline_type",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Before research starts",
                                                value: 0,
                                            },
                                            {
                                                name: "Research deadline",
                                                value: 1,
                                            },
                                            {
                                                name: "Review deadline",
                                                value: 2,
                                            },
                                            {
                                                name: "Delivery date",
                                                value: 3,
                                            },
                                            {
                                                name: "None",
                                                value: 5,
                                            },
                                        ],
                                        default: 0,
                                        description:
                                            "The deadline type of this task. Must be a valid deadline type. Possible field values:\n\n<table>\n    <thead>\n        <th>Value</th>\n        <th>Description</th>\n    </thead>\n    <tbody>\n            <tr>\n            <td>\n                0\n            </td>\n            <td>\n                Before research starts\n            </td>\n        </tr>\n            <tr>\n            <td>\n                1\n            </td>\n            <td>\n                Research deadline\n            </td>\n        </tr>\n            <tr>\n            <td>\n                2\n            </td>\n            <td>\n                Review deadline\n            </td>\n        </tr>\n            <tr>\n            <td>\n                3\n            </td>\n            <td>\n                Delivery date\n            </td>\n        </tr>\n            <tr>\n            <td>\n                5\n            </td>\n            <td>\n                None\n            </td>\n        </tr>\n        </tbody>\n</table>\n This field is required when <code>deadline_type</code> is <code>6</code>.",
                                    },
                                    {
                                        displayName: "Deadline Change",
                                        name: "deadline_change",
                                        type: "number",
                                        typeOptions: {
                                            minValue: -365,
                                            maxValue: 365,
                                        },
                                        default: -365,
                                        description:
                                            "The number of business day a specific task deadline is offset with, depending on the deadline type. Must be at least -365. Must not be greater than 365.",
                                    },
                                ],
                            },
                        ],
                        description:
                            "An array of tasks, with each task having a title, description, weight, and optionally a deadline type. Example: null",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["retrieveATaskSet"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTasksets",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the task set. Example: 367ae601fecc43a9900f40968e89d7bc",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["retrieveATaskSet"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["updateATaskSet"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTasksets",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the task set. Example: 367ae601fecc43a9900f40968e89d7bc",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["taskSet"],
                        operation: ["updateATaskSet"],
                    },
                },
                options: [
                    {
                        displayName: "Name",
                        name: "name",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The name of the task set. Example: Task Set Name",
                    },

                    {
                        displayName: "Deadline type",
                        name: "deadline_type",
                        type: "options",
                        options: [
                            {
                                name: "Before research starts",
                                value: 0,
                                description: "Before research starts",
                            },
                            {
                                name: "Research deadline",
                                value: 1,
                                description: "Research deadline",
                            },
                            {
                                name: "Review deadline",
                                value: 2,
                                description: "Review deadline",
                            },
                            {
                                name: "Delivery date",
                                value: 3,
                                description: "Delivery date",
                            },
                            {
                                name: "None",
                                value: 5,
                                description: "None",
                            },
                            {
                                name: "Per Task",
                                value: 6,
                                description: "Per Task",
                            },
                        ],
                        default: 0,
                        description:
                            "The deadline type of this task set. Must be a valid deadline type. Example: 11",
                    },

                    {
                        displayName: "Tasks",
                        name: "tasks",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        options: [
                            {
                                name: "items",
                                displayName: "Item",
                                values: [
                                    {
                                        displayName: "Title",
                                        name: "title",
                                        type: "string",
                                        default: "",
                                        description:
                                            "Must not be greater than 191 characters.",
                                    },
                                    {
                                        displayName: "Description",
                                        name: "description",
                                        type: "string",
                                        default: "",
                                        description: "",
                                    },
                                    {
                                        displayName: "Weight",
                                        name: "weight",
                                        type: "number",
                                        typeOptions: {
                                            minValue: 1,
                                            maxValue: 65535,
                                        },
                                        default: 1,
                                        description:
                                            "Must be at least 1. Must not be greater than 65535.",
                                    },
                                    {
                                        displayName: "Deadline Type",
                                        name: "deadline_type",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Before research starts",
                                                value: 0,
                                            },
                                            {
                                                name: "Research deadline",
                                                value: 1,
                                            },
                                            {
                                                name: "Review deadline",
                                                value: 2,
                                            },
                                            {
                                                name: "Delivery date",
                                                value: 3,
                                            },
                                            {
                                                name: "None",
                                                value: 5,
                                            },
                                        ],
                                        default: 0,
                                        description:
                                            "The deadline type of this individual task. Must be a valid deadline type. Possible field values:\n\n<table>\n    <thead>\n        <th>Value</th>\n        <th>Description</th>\n    </thead>\n    <tbody>\n            <tr>\n            <td>\n                0\n            </td>\n            <td>\n                Before research starts\n            </td>\n        </tr>\n            <tr>\n            <td>\n                1\n            </td>\n            <td>\n                Research deadline\n            </td>\n        </tr>\n            <tr>\n            <td>\n                2\n            </td>\n            <td>\n                Review deadline\n            </td>\n        </tr>\n            <tr>\n            <td>\n                3\n            </td>\n            <td>\n                Delivery date\n            </td>\n        </tr>\n            <tr>\n            <td>\n                5\n            </td>\n            <td>\n                None\n            </td>\n        </tr>\n        </tbody>\n</table>\n This field is required when <code>deadline_type</code> is <code>6</code>.",
                                    },
                                    {
                                        displayName: "Deadline Change",
                                        name: "deadline_change",
                                        type: "number",
                                        typeOptions: {
                                            minValue: -365,
                                            maxValue: 365,
                                        },
                                        default: -365,
                                        description:
                                            "The number of business day an individual task deadline is offset with, depending on its deadline type. Must be at least -365. Must not be greater than 365.",
                                    },
                                ],
                            },
                        ],
                        description:
                            "An array of tasks, with each task having a title, description, weight, and optionally a deadline type. Example: null",
                    },
                ],
            },

            // Test Case - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["testCase"],
                    },
                },
                options: [
                    {
                        name: "Retrieve a test case",
                        value: "retrieveATestCase",
                        action: "Retrieve a test case",
                        description:
                            "Retrieve all details of the given test case. Object information.",
                    },
                    {
                        name: "Update a test case",
                        value: "updateATestCase",
                        action: "Update a test case",
                        description:
                            "Update an existing test case. Object information.",
                    },
                ],
                default: "retrieveATestCase",
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["testCase"],
                        operation: ["retrieveATestCase"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTestcases",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the test case. Example: 1cc2796ecef04a21ab541d3ced07fab2",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["testCase"],
                        operation: ["retrieveATestCase"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["testCase"],
                        operation: ["updateATestCase"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadTestcases",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the test case. Example: 1cc2796ecef04a21ab541d3ced07fab2",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["testCase"],
                        operation: ["updateATestCase"],
                    },
                },
                options: [
                    {
                        displayName: "Notes",
                        name: "notes",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Notes about the test case. Must not be greater than 65535 characters. Example: This test case was run on 2021-01-01.",
                    },

                    {
                        displayName: "Internal notes",
                        name: "internal_notes",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "Internal notes about the test case. (Only viewable from the web application.). Must not be greater than 65535 characters. Example: This test case was run on 2021-01-01.",
                    },

                    {
                        displayName: "Findings",
                        name: "findings",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadFindings",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The IDs of the findings that are associated with this test case. Example: ["59a606a4a32229eebd4407c6a5b6f2a9"]',
                    },

                    {
                        displayName: "Explicit result",
                        name: "explicit_result",
                        type: "options",
                        options: [
                            {
                                name: "Open",
                                value: 0,
                                description: "Open",
                            },
                            {
                                name: "N/A",
                                value: 1,
                                description: "N/A",
                            },
                            {
                                name: "Fail",
                                value: 2,
                                description: "Fail",
                            },
                            {
                                name: "Pass",
                                value: 3,
                                description: "Pass",
                            },
                        ],
                        default: 0,
                        description:
                            "The explicit result of the test case. If not set, the result will be inherited from the findings. Else, the result will be set to the given value, unless if there is a linked finding with a vulnera...",
                    },
                ],
            },

            // Theme - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["theme"],
                    },
                },
                options: [
                    {
                        name: "List themes",
                        value: "listThemes",
                        action: "List themes",
                        description:
                            "Retrieve a list of all themes. Object information.",
                    },
                ],
                default: "listThemes",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["theme"],
                        operation: ["listThemes"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },
                ],
            },

            // User - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["user"],
                    },
                },
                options: [
                    {
                        name: "Retrieve token user",
                        value: "retrieveTokenUser",
                        action: "Retrieve token user",
                        description:
                            'Retrieve all details of the user who created the API token. No token permissions are required for this request. Object information. To also retrieve the avatars of the users, specify the "documents...',
                    },
                    {
                        name: "List users",
                        value: "listUsers",
                        action: "List users",
                        description:
                            'Retrieve a list of all accessible users. Object information. To also retrieve the avatars of the users, specify the "documents" relation in the request. See Including Related Data.',
                    },
                    {
                        name: "Create a user",
                        value: "createAUser",
                        action: "Create a user",
                        description:
                            "Create a new user. Object information. To add an avatar to a user, create a document for it in a separate request. See Documents.",
                    },
                    {
                        name: "Retrieve a user",
                        value: "retrieveAUser",
                        action: "Retrieve a user",
                        description:
                            'Retrieve all details of the given user. Object information. To also retrieve the avatars of the users, specify the "documents" relation in the request. See Including Related Data.',
                    },
                    {
                        name: "Update a user",
                        value: "updateAUser",
                        action: "Update a user",
                        description:
                            "Update an existing user. Object information. To add or replace an avatar for a user, create a document for it in a separate request. This will overwrite the existing avatar. See Documents.",
                    },
                ],
                default: "retrieveTokenUser",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["retrieveTokenUser"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["listUsers"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "First name,last name",
                                                value: "first_name,last_name",
                                            },
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "First name",
                                                value: "first_name",
                                            },
                                            {
                                                name: "Last name",
                                                value: "last_name",
                                            },
                                            {
                                                name: "Email",
                                                value: "email",
                                            },
                                            {
                                                name: "Status",
                                                value: "status",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "First name",
                name: "first_name",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["createAUser"],
                    },
                },
                default: "",
                description:
                    "Must not be greater than 191 characters. Example: John",
            },
            {
                displayName: "Last name",
                name: "last_name",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["createAUser"],
                    },
                },
                default: "",
                description:
                    "Must not be greater than 191 characters. Example: Doe",
            },
            {
                displayName: "Email",
                name: "email",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["createAUser"],
                    },
                },
                default: "",
                description:
                    "Must be a valid email address. Must not be greater than 191 characters. Example: john.doe@example.com",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["createAUser"],
                    },
                },
                options: [
                    {
                        displayName: "Prefix",
                        name: "prefix",
                        type: "string",
                        default: "",
                        description:
                            "Prefix. Must not be greater than 191 characters. Example: Dr.",
                    },

                    {
                        displayName: "Suffix",
                        name: "suffix",
                        type: "string",
                        default: "",
                        description:
                            "Academic title. Must not be greater than 191 characters. Example: MSc",
                    },

                    {
                        displayName: "Phone",
                        name: "phone",
                        type: "string",
                        default: "",
                        description:
                            "Must not be greater than 191 characters. Example: 0000000000000",
                    },

                    {
                        displayName: "Mobile",
                        name: "mobile",
                        type: "string",
                        default: "",
                        description:
                            "Used for SMS 2FA, including country code. Must not be greater than 191 characters. Example: +31600000000",
                    },

                    {
                        displayName: "Job title",
                        name: "job_title",
                        type: "string",
                        default: "",
                        description:
                            "Must not be greater than 191 characters. Example: Senior Penetration Tester",
                    },

                    {
                        displayName: "Location",
                        name: "location",
                        type: "string",
                        default: "",
                        description:
                            "The user's location. Must not be greater than 191 characters. Example: Amsterdam",
                    },

                    {
                        displayName: "Linkedin",
                        name: "linkedin",
                        type: "string",
                        default: "",
                        description:
                            "The user's LinkedIn page. Must not be greater than 191 characters. Example: ssplvjagucbmfhidwcsbn",
                    },

                    {
                        displayName: "Clients",
                        name: "clients",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadClients",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'Ids of the client companies the user belongs to. Only for client users. Example: ["00358b52e09d40a6bce8960aca4ac853"]',
                    },

                    {
                        displayName: "Roles",
                        name: "roles",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadRoles",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The user\'s global roles. These grant the user access to relevant functionality outside of assessments (except for the admin role which grants access to all assessments). Example: ["client"]',
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["createAUser"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsUser",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["retrieveAUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadUsers",
                },
                default: undefined,
                description:
                    "The ID of the user. Example: e557cea4c221487190999866b557594f",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["retrieveAUser"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["updateAUser"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadUsers",
                },
                default: undefined,
                description:
                    "The ID of the user. Example: e557cea4c221487190999866b557594f",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["updateAUser"],
                    },
                },
                options: [
                    {
                        displayName: "First name",
                        name: "first_name",
                        type: "string",
                        default: "",
                        description:
                            "Must not be greater than 191 characters. Example: John",
                    },

                    {
                        displayName: "Last name",
                        name: "last_name",
                        type: "string",
                        default: "",
                        description:
                            "Must not be greater than 191 characters. Example: Doe",
                    },

                    {
                        displayName: "Prefix",
                        name: "prefix",
                        type: "string",
                        default: "",
                        description:
                            "Prefix. Must not be greater than 191 characters. Example: Dr.",
                    },

                    {
                        displayName: "Suffix",
                        name: "suffix",
                        type: "string",
                        default: "",
                        description:
                            "Academic title. Must not be greater than 191 characters. Example: MSc",
                    },

                    {
                        displayName: "Email",
                        name: "email",
                        type: "string",
                        default: "",
                        description:
                            "Must be a valid email address. Must not be greater than 191 characters. Example: john.doe@example.com",
                    },

                    {
                        displayName: "Status",
                        name: "status",
                        type: "options",
                        options: [
                            {
                                name: "Active",
                                value: 1,
                                description: "Active",
                            },
                            {
                                name: "Blocked",
                                value: 2,
                                description: "Blocked",
                            },
                        ],
                        default: 1,
                        description:
                            "The user account status. Must be a valid user status. Example: 5",
                    },

                    {
                        displayName: "Phone",
                        name: "phone",
                        type: "string",
                        default: "",
                        description:
                            "Must not be greater than 191 characters. Example: 0000000000000",
                    },

                    {
                        displayName: "Mobile",
                        name: "mobile",
                        type: "string",
                        default: "",
                        description:
                            "Used for SMS 2FA, including country code. Must not be greater than 191 characters. Example: +31600000000",
                    },

                    {
                        displayName: "Job title",
                        name: "job_title",
                        type: "string",
                        default: "",
                        description:
                            "Must not be greater than 191 characters. Example: Senior Penetration Tester",
                    },

                    {
                        displayName: "Location",
                        name: "location",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description: "The user's location. Example: Amsterdam",
                    },

                    {
                        displayName: "Linkedin",
                        name: "linkedin",
                        type: "string",
                        default: "",
                        description:
                            "The user's LinkedIn page. Must not be greater than 191 characters. Example: o",
                    },
                ],
            },

            {
                displayName: "Custom Fields",
                name: "customFields",
                type: "fixedCollection",
                typeOptions: {
                    multipleValues: true,
                },
                displayOptions: {
                    show: {
                        resource: ["user"],
                        operation: ["updateAUser"],
                    },
                },
                default: {},
                description: "Custom field values",
                options: [
                    {
                        name: "customFieldValues",
                        displayName: "Custom Field",
                        values: [
                            {
                                displayName: "Field",
                                name: "fieldName",
                                type: "options",
                                typeOptions: {
                                    loadOptionsMethod:
                                        "getCustomFields_AppModelsUser",
                                },
                                default: "",
                                description: "The custom field to set",
                            },
                            {
                                displayName: "Value",
                                name: "value",
                                type: "string",
                                default: "",
                                description: "The value for the custom field",
                            },
                        ],
                    },
                ],
            },
            // User Group - Operations
            {
                displayName: "Operation",
                name: "operation",
                type: "options",
                noDataExpression: true,
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                    },
                },
                options: [
                    {
                        name: "List user groups",
                        value: "listUserGroups",
                        action: "List user groups",
                        description:
                            "Retrieve a list of all accessible user groups. Object information.",
                    },
                    {
                        name: "Create a user group",
                        value: "createAUserGroup",
                        action: "Create a user group",
                        description:
                            "Create a new user group. Object information.",
                    },
                    {
                        name: "Retrieve a user group",
                        value: "retrieveAUserGroup",
                        action: "Retrieve a user group",
                        description:
                            "Retrieve all details of the given user group. Object information.",
                    },
                    {
                        name: "Update a user group",
                        value: "updateAUserGroup",
                        action: "Update a user group",
                        description:
                            "Update an existing user group. Object information.",
                    },
                ],
                default: "listUserGroups",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["listUserGroups"],
                    },
                },
                options: [
                    {
                        displayName: "Filter fields",
                        name: "filter_fields",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Filter",
                        description: "Filter parameters as key-value pairs",
                        options: [
                            {
                                name: "filters",
                                displayName: "Filter",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "string",
                                        default: "",
                                        description: "Filter field name",
                                    },
                                    {
                                        displayName: "Value",
                                        name: "value",
                                        type: "string",
                                        default: "",
                                        description: "Filter value",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Sort",
                        name: "sort",
                        type: "fixedCollection",
                        typeOptions: {
                            multipleValues: true,
                        },
                        default: [],
                        placeholder: "Add Sort Field",
                        description: "Sort fields and directions",
                        options: [
                            {
                                name: "sorts",
                                displayName: "Sort",
                                values: [
                                    {
                                        displayName: "Field",
                                        name: "field",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Id",
                                                value: "id",
                                            },
                                            {
                                                name: "Client id",
                                                value: "client_id",
                                            },
                                            {
                                                name: "Name",
                                                value: "name",
                                            },
                                            {
                                                name: "Created at",
                                                value: "created_at",
                                            },
                                            {
                                                name: "Updated at",
                                                value: "updated_at",
                                            },
                                        ],
                                        default: "",
                                        description: "Field name to sort by",
                                    },
                                    {
                                        displayName: "Direction",
                                        name: "direction",
                                        type: "options",
                                        options: [
                                            {
                                                name: "Ascending",
                                                value: "asc",
                                            },
                                            {
                                                name: "Descending",
                                                value: "desc",
                                            },
                                        ],
                                        default: "asc",
                                        description: "Sort direction",
                                    },
                                ],
                            },
                        ],
                    },

                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Client id",
                name: "client_id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["createAUserGroup"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadClients",
                },
                default: undefined,
                description:
                    "The ID of the client. Example: f7722cf5a7014fe786013a4ece934965",
            },

            {
                displayName: "Name",
                name: "name",
                type: "string",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["createAUserGroup"],
                    },
                },
                default: "",
                description:
                    "The name of the user group. Must not be greater than 191 characters. Example: Team 1",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["createAUserGroup"],
                    },
                },
                options: [
                    {
                        displayName: "Color",
                        name: "color",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The color used to show the user group. (On creation, a random color will be used if none is provided). Example: #0000FF",
                    },

                    {
                        displayName: "Users",
                        name: "users",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadUsers",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The members of the user group. Each user must be attached to the client first. Example: ["6144002a2cd84c61b6678593837d95dc"]',
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["retrieveAUserGroup"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadUsergroups",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the user group. Example: 52e4c0475e24442ba1d1e36b962d3119",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["retrieveAUserGroup"],
                    },
                },
                options: [
                    {
                        displayName: "Include",
                        name: "include",
                        type: "string",
                        default: "",
                        description:
                            "Comma-separated list of related resources to include. Supports nested relations (e.g., sections.findings)",
                    },
                ],
            },

            {
                displayName: "Id",
                name: "id",
                type: "options",
                required: true,
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["updateAUserGroup"],
                    },
                },
                typeOptions: {
                    loadOptionsMethod: "loadUsergroups",
                    loadOptionsDependsOn: ["id"],
                },
                default: undefined,
                description:
                    "The ID of the user group. Example: 52e4c0475e24442ba1d1e36b962d3119",
            },

            {
                displayName: "Additional Fields",
                name: "additionalFields",
                type: "collection",
                placeholder: "Add Field",
                default: {},
                displayOptions: {
                    show: {
                        resource: ["userGroup"],
                        operation: ["updateAUserGroup"],
                    },
                },
                options: [
                    {
                        displayName: "Name",
                        name: "name",
                        type: "string",
                        default: "",
                        description:
                            "The name of the user group. Must not be greater than 191 characters. Example: Team 1",
                    },

                    {
                        displayName: "Color",
                        name: "color",
                        type: "string",
                        typeOptions: {
                            rows: 4,
                        },
                        default: "",
                        description:
                            "The color used to show the user group. (On creation, a random color will be used if none is provided). Example: #0000FF",
                    },

                    {
                        displayName: "Users",
                        name: "users",
                        type: "options",
                        typeOptions: {
                            loadOptionsMethod: "loadUsers",
                            multipleValues: true,
                        },
                        default: undefined,
                        description:
                            'The members of the user group. Each user must be attached to the client first. Example: ["6144002a2cd84c61b6678593837d95dc"]',
                    },
                ],
            },
        ],
    };

    methods = {
        loadOptions: {
            async getCustomFields_AppModelsAssessment(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/custom-fields`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            "filter[model_type]": "Assessment",
                            "filter[not_type]": "file",
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const customFields = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (customFields as unknown[]).map((field) => {
                        const fieldData = field as IDataObject;
                        return {
                            name: (fieldData.label || fieldData.name) as string,
                            value: fieldData.name as string,
                            description: fieldData.description
                                ? (fieldData.description as string)
                                : undefined,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async getCustomFields_AppModelsClient(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/custom-fields`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            "filter[model_type]": "Client",
                            "filter[not_type]": "file",
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const customFields = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (customFields as unknown[]).map((field) => {
                        const fieldData = field as IDataObject;
                        return {
                            name: (fieldData.label || fieldData.name) as string,
                            value: fieldData.name as string,
                            description: fieldData.description
                                ? (fieldData.description as string)
                                : undefined,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async getCustomFields_AppModelsFinding(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/custom-fields`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            "filter[model_type]": "Finding",
                            "filter[not_type]": "file",
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const customFields = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (customFields as unknown[]).map((field) => {
                        const fieldData = field as IDataObject;
                        return {
                            name: (fieldData.label || fieldData.name) as string,
                            value: fieldData.name as string,
                            description: fieldData.description
                                ? (fieldData.description as string)
                                : undefined,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async getCustomFields_AppModelsUser(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/custom-fields`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            "filter[model_type]": "User",
                            "filter[not_type]": "file",
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const customFields = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (customFields as unknown[]).map((field) => {
                        const fieldData = field as IDataObject;
                        return {
                            name: (fieldData.label || fieldData.name) as string,
                            value: fieldData.name as string,
                            description: fieldData.description
                                ? (fieldData.description as string)
                                : undefined,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },

            async loadActivitys(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/activities`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.id || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadAssessments(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.title_with_date || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadAssessmentTemplates(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessment-templates`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadClients(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/clients`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadCustomFields(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/custom-fields`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadFindings(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.title || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadFindingLayouts(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/finding-layouts`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadFindingEvents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/finding-events`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.id || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadFindingTemplates(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/finding-templates`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.title || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadLanguages(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/languages`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadOutputFiles(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/output-files`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadToolFindings(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/tool-findings`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.title || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadToolTargets(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/tool-targets`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.id || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadRoles(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/roles`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadTargets(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/targets`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadTasks(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/tasks`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.id || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadTaskSets(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/task-sets`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadThemes(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/themes`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadUsers(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/users`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const nameParts = [
                            itemData.first_name,
                            itemData.last_name,
                            itemData.email,
                        ].filter(Boolean);
                        const name = nameParts.join(" ");
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },
            async loadUserGroups(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/user-groups`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            all: "1",
                        },
                        json: true,
                    });

                    const responseData = response as IDataObject;
                    const items = Array.isArray(response)
                        ? response
                        : responseData.data || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name = itemData.name || itemData.id;
                        return {
                            name: (name || itemData.id) as string,
                            value: itemData.id as string,
                        };
                    });
                } catch (error) {
                    return [];
                }
            },

            async loadDocuments(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_comment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessment-comments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "documents",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.documents || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAssessmentcomments(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_comment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessment-comments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "replies",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.replies || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadReactions(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_comment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessment-comments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "reactions",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.reactions || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAssessmenttemplates(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "assessmentTemplate",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.assessmentTemplate || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAssessmentusers(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "assessmentUsers",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.assessmentUsers || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadNestedassessmentsections(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "nestedSections",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.nestedSections || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadOutputfiles(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "outputFiles",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.outputFiles || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAssessmentphases(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "phases",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.phases || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAssessmentsections(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "sections",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.sections || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadTasksets(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "taskSets",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.taskSets || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadUsergroups(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "userGroups",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.userGroups || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindinglayouts(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "findingLayout",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.findingLayout || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadTestcases(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "testCases",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.testCases || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAssessmentsectioncomments(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_section_comment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessment-section-comments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "replies",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.replies || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadAutoassignments(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "assessment_user_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/assessment-users/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "autoAssignments",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.autoAssignments || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingcomments(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_comment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/finding-comments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "replies",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.replies || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_comment_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/finding-comments/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "parent",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.parent || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindinglayoutfields(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_layout_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/finding-layouts/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "fields",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.fields || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingretests(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "retests",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.retests || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingretestcancelledevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "retestCancelledEvents",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.retestCancelledEvents || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingretestinquirys(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "retestInquiries",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.retestInquiries || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingstatuschanges(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "statusChanges",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.statusChanges || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingreviewevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "reviewEvents",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.reviewEvents || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingpublishedevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "publishedEvents",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.publishedEvents || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingcreatedevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "createdEvent",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.createdEvent || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingimportevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "importEvents",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.importEvents || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadFindingresolverevents(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "resolverEvents",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.resolverEvents || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadToolfindings(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "toolFindings",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.toolFindings || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadCustomfields(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "report_page_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/report-pages/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "customField",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.customField || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadReportpages(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "theme_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/themes/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "pages",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.pages || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadTooltargets(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "tool_finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/tool-findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "toolTargets",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.toolTargets || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
            async loadToolfindingtargetinfos(
                this: ILoadOptionsFunctions
            ): Promise<INodePropertyOptions[]> {
                const credentials = await this.getCredentials("reporterApi");
                const baseUrl = (credentials.url as string).replace(/\/$/, "");

                try {
                    let parentId: string | undefined;

                    // Try to get the parent ID directly (e.g., assessment_id for "Create A Finding")
                    const parentIdField = "tool_finding_id";
                    try {
                        parentId = this.getCurrentNodeParameter(
                            parentIdField
                        ) as string;
                    } catch (error) {
                        // Field doesn't exist, will try alternative approach
                    }

                    // If parent ID not found directly, try to get it from the current resource
                    // (e.g., for "Update A Finding", get finding by id, then extract assessment_id)
                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        try {
                            const resourceId = this.getCurrentNodeParameter(
                                "id"
                            ) as string;
                            if (
                                resourceId &&
                                resourceId !== "" &&
                                resourceId !== undefined &&
                                resourceId !== null
                            ) {
                                // Try to determine which resource we're working with
                                const resource = this.getNodeParameter(
                                    "resource"
                                ) as string;

                                // Fetch the current resource to get the parent ID
                                const resourceResponse =
                                    await this.helpers.httpRequest({
                                        method: "GET",
                                        url: `${baseUrl}/api/v1/${resource}s/${resourceId}`,
                                        headers: {
                                            Authorization: `Bearer ${credentials.apiToken}`,
                                            Accept: "application/vnd.api+json",
                                        },
                                        json: true,
                                    });

                                // For show routes, the response is the resource directly (no 'data' wrapper)
                                parentId = resourceResponse[parentIdField];
                            }
                        } catch (error) {
                            // Could not fetch resource, return empty
                            return [];
                        }
                    }

                    if (
                        !parentId ||
                        parentId === "" ||
                        parentId === undefined ||
                        parentId === null
                    ) {
                        return [];
                    }

                    // Fetch the parent resource with the relation included
                    const response = await this.helpers.httpRequest({
                        method: "GET",
                        url: `${baseUrl}/api/v1/tool-findings/${parentId}`,
                        headers: {
                            Authorization: `Bearer ${credentials.apiToken}`,
                            Accept: "application/vnd.api+json",
                        },
                        qs: {
                            include: "toolTargetInfos",
                        },
                        json: true,
                    });

                    // For show routes, the response is the resource directly (no 'data' wrapper)
                    const items = response.toolTargetInfos || [];

                    return (items as unknown[]).map((item) => {
                        const itemData = item as IDataObject;
                        const name =
                            itemData.name || itemData.title || itemData.id;
                        return {
                            name: String(name),
                            value: String(itemData.id),
                        };
                    });
                } catch (error) {
                    if (error instanceof Error) {
                        throw new Error(
                            `Failed to load options: ${error.message}`
                        );
                    }
                    return [];
                }
            },
        },
    };

    async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
        const items = this.getInputData();
        const credentials = await this.getCredentials("reporterApi");
        // Remove trailing slash from baseUrl to avoid double slashes
        const baseUrl = (credentials.url as string).replace(/\/$/, "");

        // Process all items in parallel using Promise.all
        const promises = items.map(
            async (_inputItem: INodeExecutionData, i: number) => {
                try {
                    const resource = this.getNodeParameter(
                        "resource",
                        i
                    ) as string;
                    const operation = this.getNodeParameter(
                        "operation",
                        i
                    ) as string;

                    let responseData: IDataObject = {};
                    let binaryData: IBinaryKeyData | undefined = undefined;

                    if (resource === "activity") {
                        if (operation === "listActivities") {
                            // List activities

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/activities`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessment") {
                        if (operation === "listAssessments") {
                            // List assessments

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAnAssessment") {
                            // Create an assessment

                            // Read URL parameters
                            const clientId = this.getNodeParameter(
                                "client_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/clients/{client_id}/assessments`;
                            url = url.replace("{client_id}", clientId);

                            // Build request body
                            const body: IDataObject = {};
                            const assessmentTemplateIdValue =
                                this.getNodeParameter(
                                    "assessment_template_id",
                                    i,
                                    ""
                                );
                            if (assessmentTemplateIdValue !== "") {
                                body["assessment_template_id"] =
                                    assessmentTemplateIdValue;
                            }
                            const titleValue = this.getNodeParameter(
                                "title",
                                i,
                                ""
                            );
                            if (titleValue !== "") {
                                body["title"] = titleValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (["tags"].includes(key)) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAnAssessment") {
                            // Retrieve an assessment

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAnAssessment") {
                            // Update an assessment

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["tags", "client_user_groups"].includes(
                                            key
                                        )
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveTheFullPDFReport") {
                            // Retrieve the full PDF report

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/pdf-reports/full`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            // This operation returns binary data (file download)
                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "*/*",
                                },
                                encoding: "arraybuffer",
                                json: false,
                                returnFullResponse: true,
                            });

                            // Extract filename from Content-Disposition header or use a default
                            const contentDisposition =
                                response.headers["content-disposition"] || "";
                            let fileName = "download";
                            const fileNameMatch = contentDisposition.match(
                                /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/
                            );
                            if (fileNameMatch && fileNameMatch[1]) {
                                fileName = fileNameMatch[1].replace(
                                    /['"]/g,
                                    ""
                                );
                            }

                            // Get MIME type from Content-Type header
                            const mimeType =
                                response.headers["content-type"] ||
                                "application/octet-stream";

                            // Convert the response body to a Buffer
                            const binaryDataBuffer = Buffer.from(
                                response.body as ArrayBuffer
                            );

                            // Store as binary data in n8n
                            const binaryPropertyName = "data";
                            binaryData = {
                                [binaryPropertyName]:
                                    await this.helpers.prepareBinaryData(
                                        binaryDataBuffer,
                                        fileName,
                                        mimeType
                                    ),
                            };
                        }

                        if (operation === "retrieveTheManagementPDFReport") {
                            // Retrieve the management PDF report

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/pdf-reports/management`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            // This operation returns binary data (file download)
                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "*/*",
                                },
                                encoding: "arraybuffer",
                                json: false,
                                returnFullResponse: true,
                            });

                            // Extract filename from Content-Disposition header or use a default
                            const contentDisposition =
                                response.headers["content-disposition"] || "";
                            let fileName = "download";
                            const fileNameMatch = contentDisposition.match(
                                /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/
                            );
                            if (fileNameMatch && fileNameMatch[1]) {
                                fileName = fileNameMatch[1].replace(
                                    /['"]/g,
                                    ""
                                );
                            }

                            // Get MIME type from Content-Type header
                            const mimeType =
                                response.headers["content-type"] ||
                                "application/octet-stream";

                            // Convert the response body to a Buffer
                            const binaryDataBuffer = Buffer.from(
                                response.body as ArrayBuffer
                            );

                            // Store as binary data in n8n
                            const binaryPropertyName = "data";
                            binaryData = {
                                [binaryPropertyName]:
                                    await this.helpers.prepareBinaryData(
                                        binaryDataBuffer,
                                        fileName,
                                        mimeType
                                    ),
                            };
                        }
                    }
                    if (resource === "assessmentComment") {
                        if (operation === "createAnAssessmentComment") {
                            // Create an assessment comment

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/assessment-comments`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const bodyValue = this.getNodeParameter(
                                "body",
                                i,
                                ""
                            );
                            if (bodyValue !== "") {
                                body["body"] = bodyValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAnAssessmentComment") {
                            // Update an assessment comment

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-comments/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessmentPhase") {
                        if (operation === "updateAnAssessmentPhase") {
                            // Update an assessment phase

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-phases/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["researchers", "reviewers"].includes(
                                            key
                                        )
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessmentSection") {
                        if (operation === "retrieveAnAssessmentSection") {
                            // Retrieve an assessment section

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-sections/{id}`;
                            url = url.replace("{id}", id);

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAnAssessmentSection") {
                            // Update an assessment section

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-sections/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessmentSectionComment") {
                        if (operation === "createAnAssessmentSectionComment") {
                            // Create an assessment section comment

                            // Read URL parameters
                            const assessmentSectionId = this.getNodeParameter(
                                "assessment_section_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-sections/{assessment_section_id}/assessment-section-comments`;
                            url = url.replace(
                                "{assessment_section_id}",
                                assessmentSectionId
                            );

                            // Build request body
                            const body: IDataObject = {};
                            const bodyValue = this.getNodeParameter(
                                "body",
                                i,
                                ""
                            );
                            if (bodyValue !== "") {
                                body["body"] = bodyValue;
                            }
                            const isPrivateValue = this.getNodeParameter(
                                "is_private",
                                i,
                                ""
                            );
                            if (isPrivateValue !== "") {
                                body["is_private"] = isPrivateValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAnAssessmentSectionComment") {
                            // Update an assessment section comment

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-section-comments/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessmentTaskSet") {
                        if (operation === "addATaskSetToAnAssessment") {
                            // Add a task set to an assessment

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/task-sets`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const taskSetIdValue = this.getNodeParameter(
                                "task_set_id",
                                i,
                                ""
                            );
                            if (taskSetIdValue !== "") {
                                body["task_set_id"] = taskSetIdValue;
                            }
                            const assignedUsersValue = this.getNodeParameter(
                                "assigned_users",
                                i,
                                ""
                            );
                            if (assignedUsersValue !== "") {
                                body["assigned_users"] = assignedUsersValue;
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "removeATaskSetFromAnAssessment") {
                            // Remove a task set from an assessment

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/task-sets/{id}`;
                            url = url.replace("{assessment_id}", assessmentId);
                            url = url.replace("{id}", id);

                            const response = await this.helpers.httpRequest({
                                method: "DELETE",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessmentTemplate") {
                        if (operation === "listAssessmentTemplates") {
                            // List assessment templates

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-templates`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAnAssessmentTemplate") {
                            // Retrieve an assessment template

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-templates/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "assessmentUser") {
                        if (operation === "createAnAssessmentUser") {
                            // Create an assessment user

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/users`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const userIdValue = this.getNodeParameter(
                                "user_id",
                                i,
                                ""
                            );
                            if (userIdValue !== "") {
                                body["user_id"] = userIdValue;
                            }
                            const typeValue = this.getNodeParameter(
                                "type",
                                i,
                                ""
                            );
                            if (typeValue !== "") {
                                body["type"] = typeValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAnAssessmentUser") {
                            // Update an assessment user

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/users/{id}`;
                            url = url.replace("{assessment_id}", assessmentId);
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "removeAnAssessmentUser") {
                            // Remove an assessment user

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/users/{id}`;
                            url = url.replace("{assessment_id}", assessmentId);
                            url = url.replace("{id}", id);

                            const response = await this.helpers.httpRequest({
                                method: "DELETE",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "client") {
                        if (operation === "listClients") {
                            // List clients

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/clients`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAClient") {
                            // Create a client

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/clients`;

                            // Build request body
                            const body: IDataObject = {};
                            const nameValue = this.getNodeParameter(
                                "name",
                                i,
                                ""
                            );
                            if (nameValue !== "") {
                                body["name"] = nameValue;
                            }
                            const descriptionValue = this.getNodeParameter(
                                "description",
                                i,
                                ""
                            );
                            if (descriptionValue !== "") {
                                body["description"] = descriptionValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (["tags"].includes(key)) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAClient") {
                            // Retrieve a client

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/clients/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAClient") {
                            // Update a client

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/clients/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (["tags"].includes(key)) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "customField") {
                        if (operation === "listCustomFields") {
                            // List custom fields

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/custom-fields`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "document") {
                        if (operation === "retrieveADocument") {
                            // Retrieve a document

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/documents/{id}`;
                            url = url.replace("{id}", id);

                            // This operation returns binary data (file download)
                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "*/*",
                                },
                                encoding: "arraybuffer",
                                json: false,
                                returnFullResponse: true,
                            });

                            // Extract filename from Content-Disposition header or use a default
                            const contentDisposition =
                                response.headers["content-disposition"] || "";
                            let fileName = "download";
                            const fileNameMatch = contentDisposition.match(
                                /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/
                            );
                            if (fileNameMatch && fileNameMatch[1]) {
                                fileName = fileNameMatch[1].replace(
                                    /['"]/g,
                                    ""
                                );
                            }

                            // Get MIME type from Content-Type header
                            const mimeType =
                                response.headers["content-type"] ||
                                "application/octet-stream";

                            // Convert the response body to a Buffer
                            const binaryDataBuffer = Buffer.from(
                                response.body as ArrayBuffer
                            );

                            // Store as binary data in n8n
                            const binaryPropertyName = "data";
                            binaryData = {
                                [binaryPropertyName]:
                                    await this.helpers.prepareBinaryData(
                                        binaryDataBuffer,
                                        fileName,
                                        mimeType
                                    ),
                            };
                        }

                        if (operation === "uploadADocument") {
                            // Upload a document

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/documents`;

                            // Build request body
                            const body: IDataObject = {};
                            const documentableTypeValue = this.getNodeParameter(
                                "documentable_type",
                                i,
                                ""
                            );
                            if (documentableTypeValue !== "") {
                                body["documentable_type"] =
                                    documentableTypeValue;
                            }
                            const sectionValue = this.getNodeParameter(
                                "section",
                                i,
                                ""
                            );
                            if (sectionValue !== "") {
                                body["section"] = sectionValue;
                            }
                            // Skip file field - will be handled separately for multipart upload

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            // This operation accepts binary data (file upload)
                            const binaryPropertyName = this.getNodeParameter(
                                "file",
                                i
                            ) as string;
                            const fileBinaryData =
                                this.helpers.assertBinaryData(
                                    i,
                                    binaryPropertyName
                                );
                            const binaryDataBuffer =
                                await this.helpers.getBinaryDataBuffer(
                                    i,
                                    binaryPropertyName
                                );

                            // Use form-data for multipart upload
                            const formData = new FormData();

                            // Add all body fields to form data
                            for (const [key, value] of Object.entries(body)) {
                                formData.append(key, String(value));
                            }

                            // Add the file using native FormData with Blob
                            // Convert Buffer to Uint8Array for TypeScript compatibility with Blob
                            const fileBlob = new Blob(
                                [new Uint8Array(binaryDataBuffer)],
                                {
                                    type:
                                        fileBinaryData.mimeType ||
                                        "application/octet-stream",
                                }
                            );
                            formData.append(
                                "file",
                                fileBlob,
                                fileBinaryData.fileName || "file"
                            );

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                },
                                body: formData,
                                json: false,
                            });
                            // Response is already parsed by n8n when Content-Type is application/json
                            responseData =
                                typeof response === "string"
                                    ? JSON.parse(response)
                                    : response;
                        }
                    }
                    if (resource === "finding") {
                        if (operation === "listFindings") {
                            // List findings

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/findings`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAFinding") {
                            // Create a finding

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/findings`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const titleValue = this.getNodeParameter(
                                "title",
                                i,
                                ""
                            );
                            if (titleValue !== "") {
                                body["title"] = titleValue;
                            }
                            const assessmentSectionIdValue =
                                this.getNodeParameter(
                                    "assessment_section_id",
                                    i,
                                    ""
                                );
                            if (assessmentSectionIdValue !== "") {
                                body["assessment_section_id"] =
                                    assessmentSectionIdValue;
                            }
                            const isVulnerabilityValue = this.getNodeParameter(
                                "is_vulnerability",
                                i,
                                ""
                            );
                            if (isVulnerabilityValue !== "") {
                                body["is_vulnerability"] = isVulnerabilityValue;
                            }
                            const reviewStatusValue = this.getNodeParameter(
                                "review_status",
                                i,
                                ""
                            );
                            if (reviewStatusValue !== "") {
                                body["review_status"] = reviewStatusValue;
                            }
                            const isPublishedValue = this.getNodeParameter(
                                "is_published",
                                i,
                                ""
                            );
                            if (isPublishedValue !== "") {
                                body["is_published"] = isPublishedValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAFinding") {
                            // Retrieve a finding

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/findings/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAFinding") {
                            // Update a finding

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/findings/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        [
                                            "resolved_targets",
                                            "draft_documents",
                                        ].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAFindingFromATemplate") {
                            // Create a finding from a template

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;
                            const findingTemplateId = this.getNodeParameter(
                                "finding_template_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/finding-templates/{finding_template_id}/findings`;
                            url = url.replace("{assessment_id}", assessmentId);
                            url = url.replace(
                                "{finding_template_id}",
                                findingTemplateId
                            );

                            // Build request body
                            const body: IDataObject = {};
                            const assessmentSectionIdValue =
                                this.getNodeParameter(
                                    "assessment_section_id",
                                    i,
                                    ""
                                );
                            if (assessmentSectionIdValue !== "") {
                                body["assessment_section_id"] =
                                    assessmentSectionIdValue;
                            }
                            const targetsValue = this.getNodeParameter(
                                "targets",
                                i,
                                ""
                            );
                            if (targetsValue !== "") {
                                body["targets"] = targetsValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "findingLayout") {
                        if (operation === "listFindingLayouts") {
                            // List finding layouts

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-layouts`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "findingEvent") {
                        if (operation === "listFindingEvents") {
                            // List finding events

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-events`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAFindingComment") {
                            // Create a finding comment

                            // Read URL parameters
                            const findingId = this.getNodeParameter(
                                "finding_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/findings/{finding_id}/finding-comments`;
                            url = url.replace("{finding_id}", findingId);

                            // Build request body
                            const body: IDataObject = {};
                            const bodyValue = this.getNodeParameter(
                                "body",
                                i,
                                ""
                            );
                            if (bodyValue !== "") {
                                body["body"] = bodyValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAFindingComment") {
                            // Update a finding comment

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-comments/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAFindingRetest") {
                            // Create a finding retest

                            // Read URL parameters
                            const findingId = this.getNodeParameter(
                                "finding_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/findings/{finding_id}/finding-retests`;
                            url = url.replace("{finding_id}", findingId);

                            // Build request body
                            const body: IDataObject = {};
                            const statusValue = this.getNodeParameter(
                                "status",
                                i,
                                ""
                            );
                            if (statusValue !== "") {
                                body["status"] = statusValue;
                            }
                            const bodyValue = this.getNodeParameter(
                                "body",
                                i,
                                ""
                            );
                            if (bodyValue !== "") {
                                body["body"] = bodyValue;
                            }
                            const reviewStatusValue = this.getNodeParameter(
                                "review_status",
                                i,
                                ""
                            );
                            if (reviewStatusValue !== "") {
                                body["review_status"] = reviewStatusValue;
                            }
                            const isPublishedValue = this.getNodeParameter(
                                "is_published",
                                i,
                                ""
                            );
                            if (isPublishedValue !== "") {
                                body["is_published"] = isPublishedValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAFindingRetest") {
                            // Update a finding retest

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-retests/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAFindingRetestInquiry") {
                            // Create a finding retest inquiry

                            // Read URL parameters
                            const findingId = this.getNodeParameter(
                                "finding_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/findings/{finding_id}/finding-retest-inquiries`;
                            url = url.replace("{finding_id}", findingId);

                            // Build request body
                            const body: IDataObject = {};
                            const bodyValue = this.getNodeParameter(
                                "body",
                                i,
                                ""
                            );
                            if (bodyValue !== "") {
                                body["body"] = bodyValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateARetestInquiry") {
                            // Update a retest inquiry

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-retest-inquiries/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (
                            operation === "createAFindingRetestCancelledEvent"
                        ) {
                            // Create a finding retest cancelled event

                            // Read URL parameters
                            const findingRetestInquiryId =
                                this.getNodeParameter(
                                    "finding_retest_inquiry_id",
                                    i
                                ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-retest-inquiries/{finding_retest_inquiry_id}/finding-retest-cancelled-events`;
                            url = url.replace(
                                "{finding_retest_inquiry_id}",
                                findingRetestInquiryId
                            );

                            // Build request body
                            const body: IDataObject = {};
                            const bodyValue = this.getNodeParameter(
                                "body",
                                i,
                                ""
                            );
                            if (bodyValue !== "") {
                                body["body"] = bodyValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateARetestCancelledEvent") {
                            // Update a retest cancelled event

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-retest-cancelled-events/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "findingTemplate") {
                        if (operation === "searchFindingTemplates") {
                            // Search finding templates

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-templates/search`;

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (["tags"].includes(key)) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "listFindingTemplates") {
                            // List finding templates

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-templates`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAFindingTemplate") {
                            // Create a finding template

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-templates`;

                            // Build request body
                            const body: IDataObject = {};
                            const titleValue = this.getNodeParameter(
                                "title",
                                i,
                                ""
                            );
                            if (titleValue !== "") {
                                body["title"] = titleValue;
                            }
                            const isVulnerabilityValue = this.getNodeParameter(
                                "is_vulnerability",
                                i,
                                ""
                            );
                            if (isVulnerabilityValue !== "") {
                                body["is_vulnerability"] = isVulnerabilityValue;
                            }
                            const descriptionValue = this.getNodeParameter(
                                "description",
                                i,
                                ""
                            );
                            if (descriptionValue !== "") {
                                body["description"] = descriptionValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["tags", "draft_documents"].includes(
                                            key
                                        )
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAFindingTemplate") {
                            // Retrieve a finding template

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-templates/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAFindingTemplate") {
                            // Update a finding template

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/finding-templates/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (["tags"].includes(key)) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "language") {
                        if (operation === "listLanguages") {
                            // List languages

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/languages`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "outputFile") {
                        if (operation === "uploadAnOutputFileToParse") {
                            // Upload an output file to parse

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/output-files`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const nameValue = this.getNodeParameter(
                                "name",
                                i,
                                ""
                            );
                            if (nameValue !== "") {
                                body["name"] = nameValue;
                            }
                            // Skip file field - will be handled separately for multipart upload
                            const toolValue = this.getNodeParameter(
                                "tool",
                                i,
                                ""
                            );
                            if (toolValue !== "") {
                                body["tool"] = toolValue;
                            }

                            // This operation accepts binary data (file upload)
                            const binaryPropertyName = this.getNodeParameter(
                                "file",
                                i
                            ) as string;
                            const fileBinaryData =
                                this.helpers.assertBinaryData(
                                    i,
                                    binaryPropertyName
                                );
                            const binaryDataBuffer =
                                await this.helpers.getBinaryDataBuffer(
                                    i,
                                    binaryPropertyName
                                );

                            // Use form-data for multipart upload
                            const formData = new FormData();

                            // Add all body fields to form data
                            for (const [key, value] of Object.entries(body)) {
                                formData.append(key, String(value));
                            }

                            // Add the file using native FormData with Blob
                            // Convert Buffer to Uint8Array for TypeScript compatibility with Blob
                            const fileBlob = new Blob(
                                [new Uint8Array(binaryDataBuffer)],
                                {
                                    type:
                                        fileBinaryData.mimeType ||
                                        "application/octet-stream",
                                }
                            );
                            formData.append(
                                "file",
                                fileBlob,
                                fileBinaryData.fileName || "file"
                            );

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                },
                                body: formData,
                                json: false,
                            });
                            // Response is already parsed by n8n when Content-Type is application/json
                            responseData =
                                typeof response === "string"
                                    ? JSON.parse(response)
                                    : response;
                        }

                        if (operation === "listOutputFiles") {
                            // List output files

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/output-files`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "toolFinding") {
                        if (operation === "listToolFindings") {
                            // List tool findings

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tool-findings`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAToolFinding") {
                            // Retrieve a tool finding

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tool-findings/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAToolFinding") {
                            // Update a tool finding

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tool-findings/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "toolTarget") {
                        if (operation === "listToolTargets") {
                            // List tool targets

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tool-targets`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAToolTarget") {
                            // Update a tool target

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tool-targets/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "reaction") {
                        if (operation === "createAReaction") {
                            // Create a reaction

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/reactions`;

                            // Build request body
                            const body: IDataObject = {};
                            const modelTypeValue = this.getNodeParameter(
                                "model_type",
                                i,
                                ""
                            );
                            if (modelTypeValue !== "") {
                                body["model_type"] = modelTypeValue;
                            }
                            const modelIdValue = this.getNodeParameter(
                                "model_id",
                                i,
                                ""
                            );
                            if (modelIdValue !== "") {
                                body["model_id"] = modelIdValue;
                            }
                            const reactionValue = this.getNodeParameter(
                                "reaction",
                                i,
                                ""
                            );
                            if (reactionValue !== "") {
                                body["reaction"] = reactionValue;
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "role") {
                        if (operation === "listGlobalRoles") {
                            // List global roles

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/roles`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "listAssessmentRoles") {
                            // List assessment roles

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessment-roles`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "target") {
                        if (operation === "listTargets") {
                            // List targets

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/targets`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createATarget") {
                            // Create a target

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/targets`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const targetTypeValue = this.getNodeParameter(
                                "target_type",
                                i,
                                ""
                            );
                            if (targetTypeValue !== "") {
                                body["target_type"] = targetTypeValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if ([""].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else if (
                                        ["draft_documents"].includes(key)
                                    ) {
                                        // Handle array of strings fields
                                        // Extract values from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{value: 'str1'}, {value: 'str2'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            const valueObj = value as {
                                                items: unknown[];
                                            };
                                            body[key] = valueObj.items.map(
                                                (item) => {
                                                    const itemData =
                                                        item as IDataObject;
                                                    return itemData.value;
                                                }
                                            );
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveATarget") {
                            // Retrieve a target

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/targets/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateATarget") {
                            // Update a target

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/targets/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "task") {
                        if (operation === "listTasks") {
                            // List tasks

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tasks`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveATask") {
                            // Retrieve a task

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tasks/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateATask") {
                            // Update a task

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/tasks/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createATask") {
                            // Create a task

                            // Read URL parameters
                            const assessmentId = this.getNodeParameter(
                                "assessment_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/assessments/{assessment_id}/tasks`;
                            url = url.replace("{assessment_id}", assessmentId);

                            // Build request body
                            const body: IDataObject = {};
                            const dataValue = this.getNodeParameter(
                                "data",
                                i,
                                ""
                            );
                            if (dataValue !== "") {
                                body["data"] = dataValue;
                            }
                            const deadlineTypeValue = this.getNodeParameter(
                                "deadline_type",
                                i,
                                ""
                            );
                            if (deadlineTypeValue !== "") {
                                body["deadline_type"] = deadlineTypeValue;
                            }
                            const weightValue = this.getNodeParameter(
                                "weight",
                                i,
                                ""
                            );
                            if (weightValue !== "") {
                                body["weight"] = weightValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "taskSet") {
                        if (operation === "listTaskSets") {
                            // List task sets

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/task-sets`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createATaskSet") {
                            // Create a task set

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/task-sets`;

                            // Build request body
                            const body: IDataObject = {};
                            const nameValue = this.getNodeParameter(
                                "name",
                                i,
                                ""
                            );
                            if (nameValue !== "") {
                                body["name"] = nameValue;
                            }
                            const deadlineTypeValue = this.getNodeParameter(
                                "deadline_type",
                                i,
                                ""
                            );
                            if (deadlineTypeValue !== "") {
                                body["deadline_type"] = deadlineTypeValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if (["tasks"].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveATaskSet") {
                            // Retrieve a task set

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/task-sets/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateATaskSet") {
                            // Update a task set

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/task-sets/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Handle fixedCollection fields (arrays of objects)
                                    if (["tasks"].includes(key)) {
                                        // Extract items from fixedCollection format
                                        // n8n fixedCollection returns: {items: [{...}, {...}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "items" in value &&
                                            Array.isArray(value.items)
                                        ) {
                                            body[key] = value.items;
                                        } else {
                                            body[key] = value;
                                        }
                                    } else {
                                        body[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "testCase") {
                        if (operation === "retrieveATestCase") {
                            // Retrieve a test case

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/test-cases/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateATestCase") {
                            // Update a test case

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/test-cases/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "theme") {
                        if (operation === "listThemes") {
                            // List themes

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/themes`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "user") {
                        if (operation === "retrieveTokenUser") {
                            // Retrieve token user

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/users/me`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "listUsers") {
                            // List users

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/users`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAUser") {
                            // Create a user

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/users`;

                            // Build request body
                            const body: IDataObject = {};
                            const firstNameValue = this.getNodeParameter(
                                "first_name",
                                i,
                                ""
                            );
                            if (firstNameValue !== "") {
                                body["first_name"] = firstNameValue;
                            }
                            const lastNameValue = this.getNodeParameter(
                                "last_name",
                                i,
                                ""
                            );
                            if (lastNameValue !== "") {
                                body["last_name"] = lastNameValue;
                            }
                            const emailValue = this.getNodeParameter(
                                "email",
                                i,
                                ""
                            );
                            if (emailValue !== "") {
                                body["email"] = emailValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAUser") {
                            // Retrieve a user

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/users/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAUser") {
                            // Update a user

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/users/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            // Add custom fields to body
                            const customFields = this.getNodeParameter(
                                "customFields",
                                i,
                                {}
                            ) as IDataObject;
                            if (
                                customFields.customFieldValues &&
                                Array.isArray(customFields.customFieldValues)
                            ) {
                                for (const customField of customFields.customFieldValues) {
                                    const fieldName =
                                        customField.fieldName as string;
                                    const value = customField.value;
                                    if (fieldName && value !== "") {
                                        body[fieldName] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }
                    if (resource === "userGroup") {
                        if (operation === "listUserGroups") {
                            // List user groups

                            // Read URL parameters

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/user-groups`;

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "createAUserGroup") {
                            // Create a user group

                            // Read URL parameters
                            const clientId = this.getNodeParameter(
                                "client_id",
                                i
                            ) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/clients/{client_id}/user-groups`;
                            url = url.replace("{client_id}", clientId);

                            // Build request body
                            const body: IDataObject = {};
                            const nameValue = this.getNodeParameter(
                                "name",
                                i,
                                ""
                            );
                            if (nameValue !== "") {
                                body["name"] = nameValue;
                            }

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "POST",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "retrieveAUserGroup") {
                            // Retrieve a user group

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/user-groups/{id}`;
                            url = url.replace("{id}", id);

                            // Build query parameters
                            const qs: IDataObject = {};

                            // Add optional query parameters from Additional Fields
                            const additionalFieldsForQuery =
                                this.getNodeParameter(
                                    "additionalFields",
                                    i,
                                    {}
                                ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFieldsForQuery
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    // Special handling for filter_fields - convert to Spatie Query Builder format
                                    if (key === "filter_fields") {
                                        // Handle fixedCollection format: {filters: [{field: 'severity', value: '10'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "filters" in value
                                        ) {
                                            const filterData = value as {
                                                filters: Array<{
                                                    field: string;
                                                    value: string;
                                                }>;
                                            };
                                            if (
                                                Array.isArray(
                                                    filterData.filters
                                                )
                                            ) {
                                                for (const filter of filterData.filters) {
                                                    if (
                                                        filter.field &&
                                                        filter.value !== "" &&
                                                        filter.value !== null &&
                                                        filter.value !==
                                                            undefined
                                                    ) {
                                                        qs[
                                                            `filter[${filter.field}]`
                                                        ] = filter.value;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (key === "sort") {
                                        // Handle fixedCollection format: {sorts: [{field: 'created_at', direction: 'desc'}]}
                                        if (
                                            value &&
                                            typeof value === "object" &&
                                            "sorts" in value
                                        ) {
                                            const sortData = value as {
                                                sorts: Array<{
                                                    field: string;
                                                    direction: string;
                                                }>;
                                            };
                                            if (Array.isArray(sortData.sorts)) {
                                                const sortParts: string[] = [];
                                                for (const sort of sortData.sorts) {
                                                    if (sort.field) {
                                                        const prefix =
                                                            sort.direction ===
                                                            "desc"
                                                                ? "-"
                                                                : "";
                                                        sortParts.push(
                                                            `${prefix}${sort.field}`
                                                        );
                                                    }
                                                }
                                                if (sortParts.length > 0) {
                                                    qs["sort"] =
                                                        sortParts.join(",");
                                                }
                                            }
                                        }
                                    } else if (key === "include") {
                                        if (
                                            value &&
                                            typeof value === "string" &&
                                            value.trim()
                                        ) {
                                            qs["include"] = value.trim();
                                        }
                                    } else {
                                        qs[key] = value;
                                    }
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "GET",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                qs,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }

                        if (operation === "updateAUserGroup") {
                            // Update a user group

                            // Read URL parameters
                            const id = this.getNodeParameter("id", i) as string;

                            // Build URL with parameters
                            let url = `${baseUrl}/api/v1/user-groups/{id}`;
                            url = url.replace("{id}", id);

                            // Build request body
                            const body: IDataObject = {};

                            // Add optional body parameters from Additional Fields
                            const additionalFields = this.getNodeParameter(
                                "additionalFields",
                                i,
                                {}
                            ) as IDataObject;
                            for (const [key, value] of Object.entries(
                                additionalFields
                            )) {
                                if (
                                    value !== "" &&
                                    value !== null &&
                                    value !== undefined
                                ) {
                                    body[key] = value;
                                }
                            }

                            const response = await this.helpers.httpRequest({
                                method: "PUT",
                                url,
                                headers: {
                                    Authorization: `Bearer ${credentials.apiToken}`,
                                    Accept: "application/vnd.api+json",
                                    "Content-Type": "application/json",
                                },
                                body,
                                json: true,
                            });
                            responseData = response as IDataObject;
                        }
                    }

                    const executionData: INodeExecutionData = {
                        json: responseData,
                    };
                    if (binaryData) {
                        executionData.binary = binaryData;
                    }
                    return executionData;
                } catch (error: unknown) {
                    // Extract validation errors from the response if available
                    const errorObj = error as IDataObject;
                    let errorMessage =
                        error instanceof Error ? error.message : String(error);
                    let responseBody: IDataObject | string | null = null;

                    // Axios errors have the response data in error.response.data
                    if (
                        errorObj.response &&
                        typeof errorObj.response === "object"
                    ) {
                        const response = errorObj.response as IDataObject;
                        if (response.data) {
                            responseBody = response.data as
                                | IDataObject
                                | string;
                        } else if (response.body) {
                            responseBody = response.body as
                                | IDataObject
                                | string;
                        }
                    } else if (
                        errorObj.errors &&
                        typeof errorObj.errors === "object"
                    ) {
                        // This is likely the Laravel validation response directly
                        responseBody = errorObj;
                    } else if (
                        errorObj.cause &&
                        typeof errorObj.cause === "object"
                    ) {
                        const cause = errorObj.cause as IDataObject;
                        if (
                            cause.response &&
                            typeof cause.response === "object"
                        ) {
                            const causeResponse = cause.response as IDataObject;
                            if (causeResponse.data) {
                                responseBody = causeResponse.data as
                                    | IDataObject
                                    | string;
                            } else if (causeResponse.body) {
                                responseBody = causeResponse.body as
                                    | IDataObject
                                    | string;
                            }
                        }
                    } else if (
                        errorObj.description &&
                        typeof errorObj.description === "string"
                    ) {
                        // Sometimes n8n puts the response in the description
                        try {
                            responseBody = JSON.parse(errorObj.description);
                        } catch (e) {
                            // Not JSON, ignore
                        }
                    }

                    // Parse the response body if it's a string
                    if (typeof responseBody === "string") {
                        try {
                            responseBody = JSON.parse(responseBody);
                        } catch (e) {
                            // Not JSON, ignore
                        }
                    }

                    // Extract Laravel validation errors
                    if (responseBody && typeof responseBody === "object") {
                        const body = responseBody as IDataObject;
                        if (body.errors && typeof body.errors === "object") {
                            const errors = body.errors as IDataObject;
                            const validationErrors = Object.entries(errors)
                                .map(([field, messages]: [string, unknown]) => {
                                    const messageList = Array.isArray(messages)
                                        ? messages.join(", ")
                                        : String(messages);
                                    return `${field}: ${messageList}`;
                                })
                                .join("; ");
                            errorMessage = `Validation failed: ${validationErrors}`;
                        } else if (body.message) {
                            errorMessage = String(body.message);
                        }
                    }

                    if (this.continueOnFail()) {
                        return { json: { error: errorMessage } };
                    }

                    // Add more context to the error
                    const resource = this.getNodeParameter(
                        "resource",
                        i
                    ) as string;
                    const operation = this.getNodeParameter(
                        "operation",
                        i
                    ) as string;
                    const contextualError = new Error(
                        `[${resource}/${operation}] ${errorMessage}`
                    );
                    throw contextualError;
                }
            }
        );

        // Wait for all promises to complete
        const returnData = await Promise.all(promises);

        return [returnData];
    }
}
